(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{11:function(t,e,r){"use strict";r(233);var n=r(234);r.d(e,"Events",(function(){return n.a}));var o=r(268);r.d(e,"arrayUnique",(function(){return o.a}));r(270);var i=r(269);r.d(e,"numberWithSpaces",(function(){return i.a}));var a=r(271);r.d(e,"reEscape",(function(){return a.a}));var s=r(235);r.d(e,"fixUrlStr",(function(){return s.a}));var u=r(236);r.d(e,"sleep",(function(){return u.a}));var c=r(237);r.d(e,"defined",(function(){return c.a}));var p=r(238);r.o(p,"Clipboard")&&r.d(e,"Clipboard",(function(){return p.Clipboard})),r.o(p,"debounce")&&r.d(e,"debounce",(function(){return p.debounce})),r.o(p,"deepmerge")&&r.d(e,"deepmerge",(function(){return p.deepmerge})),r.o(p,"mixinProperties")&&r.d(e,"mixinProperties",(function(){return p.mixinProperties}));var l=r(241);r.d(e,"mixinProperties",(function(){return l.a}));var f=r(242);r.d(e,"deepmerge",(function(){return f.a}));var h=r(243);r.d(e,"debounce",(function(){return h.a}));var d=r(244);r.d(e,"Clipboard",(function(){return d.a}))},112:function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var n=r(49),o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var i={get:function(t,e){var r=e[0];return t.properties&&t.properties[r]},match:function(t,e){var r=e[0],n=e.slice(1),o=r;Array.isArray(r)&&(o=a(t,r));for(var i=n.splice(-1,n.length%2)[0],s=0;s<n.length-1;s+=2){if(n[s]===o)return n[s+1]}return i}};function a(t,e){var r=e[0],n=e.slice(1),o=i[r];if(o)return o(t,n)}function s(t){return function(e){return a(e,t)}}var u=["iconSize","iconAnchor"];function c(t){var e=!1,r={};for(var i in t)if(-1===u.indexOf(i)){var a=i,c=t[a];Object(n.a)(c)&&(e=!0,r[a]=s(c))}if(e)return function(e){var n={};for(var i in r)n[i]=r[i](e);return o(o({},t),n)}}},113:function(t,e,r){"use strict";function n(t){return"[object Object]"===Object.prototype.toString.call(t)}r.d(e,"a",(function(){return n}))},119:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n,o=r(50),i=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(t){function e(r){var n=t.call(this,r)||this;return n.name="ResourceNotFoundError",n.exception="nextgisweb.resource.exception.ResourceNotFound",Object.setPrototypeOf(n,e.prototype),n}return i(e,t),e}(o.a)},148:function(t,e,r){"use strict";r.d(e,"a",(function(){return q}));var n=r(56);function o(t){for(var e,r={},n=0;n<t.length;n++)r[t[n]]=1+(r[t[n]]||0);for(var o in r){var i=void 0!==e?r[e]:0;r[o]>(i||0)&&(e=o)}return e}function i(t){var e;if("FeatureCollection"===t.type)e=o(t.features.map((function(t){return t.geometry.type})));else if("GeometryCollection"===t.type){e=o(t.geometries.map((function(t){return t.type})))}else e="Feature"===t.type?t.geometry.type:t.type;return e}var a={polygon:"path",line:"path",point:"circle"},s={Point:"point",LineString:"line",MultiPoint:"point",Polygon:"polygon",MultiLineString:"line",MultiPolygon:"polygon"};function u(t){if(t.data){var e=s[i(t.data)],r=t.paint;r&&Object(n.isPaint)(r)&&(r.type=r.type?r.type:"polygon"===e||"line"===e?"path":"html"in r||"className"in r?"icon":a[e]),t.type=t.type||e}return t}var c,p=r(37),l=r(23),f=r(11),h=function(){this.backspace=8,this.tab=9,this.enter=13,this.shift=16,this.ctrl=17,this.alt=18,this["pause/break"]=19,this.caps_lock=20,this.escape=27,this.page_up=33,this.page_down=34,this.end=35,this.home=36,this.left_arrow=37,this.up_arrow=38,this.right_arrow=39,this.down_arrow=40,this.insert=45,this.delete=46,this.left_window_key=91,this.right_window_key=92,this.select_key=93,this.numpad_0=96,this.numpad_1=97,this.numpad_2=98,this.numpad_3=99,this.numpad_4=100,this.numpad_5=101,this.numpad_6=102,this.numpad_7=103,this.numpad_8=104,this.numpad_9=105,this.multiply=106,this.add=107,this.subtract=109,this.decimal_point=110,this.divide=111,this.f1=112,this.f2=113,this.f3=114,this.f4=115,this.f5=116,this.f6=117,this.f7=118,this.f8=119,this.f9=120,this.f10=121,this.f11=122,this.f12=123,this.num_lock=144,this.scroll_lock=145,this["semi-colon"]=186,this.equal_sign=187,this[","]=188,this["-"]=189,this["."]=190,this["/"]=191,this["`"]=192,this["["]=219,this["\\"]=220,this["]"]=221,this["'"]=222},d=function(){function t(){this.keyCodeAlias=new h,this.keys={},this._windowOnFocus=this.windowOnFocus.bind(this),this._keysPressed=this.keysPressed.bind(this),this._keysReleased=this.keysReleased.bind(this),this.addKeyboardEventsListener()}return t.prototype.pressed=function(t){var e=this.keyCodeAlias[t];return!!e&&this.keys[e]},t.prototype.addKeyboardEventsListener=function(){"undefined"!=typeof window&&(window.addEventListener("focus",this._windowOnFocus,!1),window.addEventListener("keydown",this._keysPressed,!1),window.addEventListener("keyup",this._keysReleased,!1))},t.prototype.removeKeyboardEventsListener=function(){"undefined"!=typeof window&&(window.removeEventListener("focus",this._windowOnFocus,!1),window.removeEventListener("keydown",this._keysPressed,!1),window.removeEventListener("keyup",this._keysReleased,!1))},t.prototype.keysPressed=function(t){t.stopPropagation(),this.keys[t.keyCode]||(this.keys[t.keyCode]=!0)},t.prototype.keysReleased=function(t){t.stopPropagation(),this.keys[t.keyCode]=!1},t.prototype.windowOnFocus=function(){this.keys={}},t}(),y=function(){function t(t,e){this.webMap=t,e&&(e.value&&this.setValue(e.value),e.name&&(this.name=e.name),e.event&&(this.event=e.event))}return t.prototype.getValue=function(){return this.value},t.prototype.setValue=function(t){this.value=t},t}(),v=(c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="center",e.event="moveend",e}return v(e,t),e.prototype.getValue=function(){return this.webMap.getCenter()},e.prototype.setValue=function(t){this.webMap.setCenter(t)},e.prototype.toString=function(t){var e=t.map((function(t){return t.toFixed(5)}));return e[0]+"_"+e[1]},e.prototype.parse=function(t){return t.split("_").map(Number)},e}(y),_=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.name="zoom",e.event="zoomend",e}return _(e,t),e.prototype.getValue=function(){var t=this.webMap.getZoom();return void 0!==t?Math.round(t):void 0},e.prototype.setValue=function(t){this.webMap.setZoom(t)},e.prototype.toString=function(t){return String(t)},e.prototype.parse=function(t){return Number(t)},e}(y);function b(t,e){var r=document.createElement("div"),n=!1;e.getStatus?n=e.getStatus():e.status&&(n=e.status);var o=e.title||"",i=e.html;function a(){o&&(r.title="string"==typeof o?o:n?o.on:o.off,r.setAttribute("aria-label",r.title))}function s(t){t instanceof HTMLElement?(r.innerHTML="",r.appendChild(t)):"string"==typeof t&&(r.innerHTML=t)}function u(){i&&("string"==typeof i||i instanceof HTMLElement?s(i):s(n?i.on:i.off),r.setAttribute("aria-label",r.title))}function c(t,e){t.split(" ").forEach((function(t){e?r.classList.add(t):r.classList.remove(t)}))}function p(){e.addClassOn&&c(e.addClassOn,n),e.addClassOff&&c(e.addClassOff,!n)}a(),u(),e.addClass&&c(e.addClass,!0),p();var l=function(t){void 0!==t&&(n=t),u(),a(),p()},f=function(t){if(n=void 0!==t?t:!n,e.onClick){var r=e.onClick(n);Promise.resolve(r).then((function(){return l()})).catch((function(){return n=!n}))}else l()},h=t({html:r,onClick:f});return h.onClick=f,h.changeStatus=l,h}function w(t){return function(e,r,n){var o=n.value;return n.value=function(){for(var e=this,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return new Promise((function(n,i){var a=function(){var t=o.apply(e,r);t&&t.then?t.then(n).catch(i):n(t)};e.getEventStatus(t)?a():e.emitter.once(t,(function(){a()}))}))},n}}function L(t){var e=[t[0],t[1]];return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],[t[2],t[3]],[t[0],t[3]],e]]}}}var O=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},P=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},C=0,E={},S={minZoom:0,maxZoom:21,paint:{color:"blue",opacity:1,radius:8,weight:1},selectedPaint:{color:"darkblue",opacity:1,radius:12,weight:1}},A=function(){function t(e){this.options=S,this.emitter=new l.EventEmitter,this.keys=t.keys,this.runtimeParams=[],this.getPaintFunctions=t.getPaintFunctions,this.mapState=[m,g],this.id=C++,this._initMapState={},this._mapState=[],this._eventsStatus={},this._mapEvents={},E[this.id]=this,this.mapAdapter=e.mapAdapter,this._starterKits=e.starterKits||[],e.mapOptions&&(this.options=Object(f.deepmerge)(S||{},e.mapOptions)),e.runtimeParams&&(this.runtimeParams=e.runtimeParams),this._addEventsListeners(),e.create&&this.create(this.options)}return t.get=function(t){return E[t]},t.prototype.getId=function(){return this.id},t.prototype.create=function(t){return O(this,void 0,void 0,(function(){return P(this,(function(e){switch(e.label){case 0:return this.getEventStatus("create")?[3,3]:(this.options=Object(f.deepmerge)(S||{},t||{}),[4,this._setInitMapState(this.mapState)]);case 1:return e.sent(),[4,this._setupMap()];case 2:e.sent(),this._emitStatusEvent("create",this),e.label=3;case 3:return[2,this]}}))}))},t.prototype.setRuntimeParams=function(t){this.runtimeParams.push(t)},t.prototype.destroy=function(){this._removeEventListeners(),function(t){for(var e in t)delete t[e]}(this._emitStatusEvent),this.mapAdapter.destroy&&this.mapAdapter.destroy()},t.prototype.getState=function(){var t={};return this._mapState.forEach((function(e){t[e.name]=e.getValue()})),t},t.prototype.getRuntimeParams=function(){var t=this,e={};return this._mapState.forEach((function(r){for(var n=0,o=t.runtimeParams;n<o.length;n++){var i=o[n].get(r.name);if(void 0!==i){e[r.name]=r.parse(i);break}}})),e},t.prototype.getContainer=function(){if(this.mapAdapter.getContainer)return this.mapAdapter.getContainer();if(this.options.target){if(this.options.target instanceof HTMLElement)return this.options.target;if("string"==typeof this.options.target){var t=document.getElementById(this.options.target);if(t)return t}}},t.prototype.setCursor=function(t){this.mapAdapter.setCursor&&this.mapAdapter.setCursor(t)},t.prototype.setCenter=function(t){return this.mapAdapter.setCenter(t),this},t.prototype.getCenter=function(){return this.mapAdapter.getCenter()},t.prototype.getBounds=function(){if(this.mapAdapter.getBounds)return this.mapAdapter.getBounds()},t.prototype.getBoundsPolygon=function(){var t=this.getBounds();if(t)return L(t)},t.prototype.setZoom=function(t){return this.mapAdapter.setZoom(t),this},t.prototype.getZoom=function(){return this.mapAdapter.getZoom()},t.prototype.zoomIn=function(){if(this.mapAdapter.zoomIn)this.mapAdapter.zoomIn();else{var t=this.getZoom();if(t){var e=t+1;this.setZoom(e)}}},t.prototype.zoomOut=function(){if(this.mapAdapter.zoomOut)this.mapAdapter.zoomOut();else{var t=this.getZoom();if(t){var e=t-1;this.setZoom(e)}}},t.prototype.setView=function(t,e){this.mapAdapter.setView&&t&&e?this.mapAdapter.setView(t,e):(t&&this.mapAdapter.setCenter(t),e&&this.mapAdapter.setZoom(e))},t.prototype.fitBounds=function(t,e){return t.every((function(t){return Object(f.defined)(t)}))&&(t[1]<-85.06&&(t[1]=-85.06),t[3]>85.06&&(t[3]=85.06),this.mapAdapter.fitBounds(t,e)),this},t.prototype.getEventStatus=function(t){var e=t,r=this._eventsStatus[e];return null!=r&&r},t.prototype.onLoad=function(t){var e=this;return void 0===t&&(t="create"),new Promise((function(r){e.getEventStatus(t)?r(e):e.emitter.once(t,(function(){r(e)}))}))},t.prototype.onMapLoad=function(t){var e=this;return new Promise((function(r){var n,o=function(){var n=e.mapAdapter;t&&t(n),n&&r(n)},i=null===(n=e.mapAdapter.isLoaded)||void 0===n||n;e.mapAdapter.map&&i?o():e.mapAdapter.emitter.once("create",(function(){o()}))}))},t.prototype.getLayerAdapters=function(){return this.mapAdapter.layerAdapters},t.prototype.getLayerAdapter=function(t){return this.mapAdapter.layerAdapters[t]},t.prototype.locate=function(t,e){if(this.mapAdapter&&this.mapAdapter.locate)return this.mapAdapter.locate(t,e);return{stop:function(){return{}}}},t.prototype._emitStatusEvent=function(t,e){var r=t;this._eventsStatus[r]=!0,this.emitter.emit(r,e)},t.prototype._addLayerProviders=function(){return O(this,void 0,void 0,(function(){return P(this,(function(t){return[2]}))}))},t.prototype._onLoadSync=function(){return O(this,void 0,void 0,(function(){return P(this,(function(t){return[2]}))}))},t.prototype._setupMap=function(){return O(this,void 0,void 0,(function(){return P(this,(function(t){switch(t.label){case 0:return[4,this.mapAdapter.create(this.options)];case 1:return t.sent(),this._zoomToInitialExtent(),[4,this._addLayerProviders()];case 2:return t.sent(),[4,this._onLoadSync()];case 3:return t.sent(),this._emitStatusEvent("build-map",this.mapAdapter),[2,this]}}))}))},t.prototype._zoomToInitialExtent=function(){var t=this.options,e=t.center,r=t.zoom,n=t.bounds;this._extent?this.fitBounds(this._extent):e&&r?this.setView(e,r):n&&this.fitBounds(n)},t.prototype._setInitMapState=function(t){for(var e=0,r=t;e<r.length;e++){var n=new(0,r[e])(this);this._mapState.push(n);for(var o=0,i=this.runtimeParams;o<i.length;o++){var a=i[o].get(n.name);if(void 0!==a){var s=n.parse(a);this._initMapState[n.name]=s,this.options[n.name]=s;break}}}},t.prototype._addEventsListeners=function(){var t=this;["preclick","click","zoomstart","zoom","zoomend","movestart","move","moveend"].forEach((function(e){t._mapEvents[e]=function(r){if(t.runtimeParams.length){var n=t._mapState.find((function(t){return t.event===e}));if(n){var o=n.toString(n.getValue());t.runtimeParams.forEach((function(t){t.set(n.name,o)}))}}t._eventsStatus&&t.emitter.emit(e,r)},t.mapAdapter.emitter.on(e,t._mapEvents[e])}))},t.prototype._removeEventListeners=function(){var t=this;Object.entries(this._mapEvents).forEach((function(e){var r=e[0],n=e[1];t.mapAdapter.emitter.off(r,n)}))},t.keys=new d,t.utils={detectGeometryType:i,findMostFrequentGeomType:o,updateGeoJsonAdapterOptions:u,propertiesFilter:p.c,createToggleControl:b,getBoundsPolygon:L},t.decorators={onLoad:w},t}(),k=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),x=function(){return(x=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},F=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},j=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._layersIdCounter=1,e._layersOrderCounter=1,e._baselayers=[],e._layers={},e._selectedLayers=[],e}return k(e,t),e.prototype.fitLayer=function(t,e){return F(this,void 0,void 0,(function(){var r,n;return j(this,(function(o){switch(o.label){case 0:return(r=this.getLayer(t))&&r.getExtent?[4,r.getExtent()]:[3,2];case 1:(n=o.sent())&&this.fitBounds(n,e),o.label=2;case 2:return[2]}}))}))},e.prototype.isBaseLayer=function(t){var e=this.getLayer(t);if(e&&e.id)return-1!==this._baselayers.indexOf(e.id)},e.prototype.getBaseLayers=function(){var t=this,e=[];return this._baselayers.forEach((function(r){var n=t._layers[r];n&&e.push(n)})),e},e.prototype.getBaseLayersIds=function(){return this._baselayers},e.prototype.getLayer=function(t){return"string"==typeof t?this._layers[t]:t},e.prototype.getLayerId=function(t){var e=this.getLayer(t);if(e&&e.options)return e.options.id;throw new Error("No id for layer")},e.prototype.getLayers=function(){return Object.keys(this._layers)},e.prototype.allLayers=function(){return this._layers},e.prototype.findLayer=function(t){for(var e in this._layers){var r=this._layers[e];if(t(r))return r}},e.prototype.isLayerVisible=function(t){var e=this.getLayer(t);return!(!e||void 0===e.options.visibility)&&e.options.visibility},e.prototype.addBaseLayer=function(t,e){return F(this,void 0,void 0,(function(){return j(this,(function(r){switch(r.label){case 0:return[4,this.addLayer(t,x(x({},e),{baselayer:!0}))];case 1:return[2,r.sent()]}}))}))},e.prototype.addLayer=function(t,e,r){var n,o,i;return void 0===e&&(e={}),F(this,void 0,void 0,(function(){var a,s,u,c,p,l,f,h,d,y,v,m,_,g;return j(this,(function(b){switch(b.label){case 0:return e.baselayer=null!==(n=e.baselayer)&&void 0!==n?n:e.baseLayer,a=this._layersIdCounter++,s=void 0!==r?r:void 0!==e.order?e.order:this.reserveOrder(),"string"!=typeof t?[3,1]:(u=this.getLayerAdapter(t),[3,4]);case 1:return"function"!=typeof t?[3,2]:(u=t,[3,4]);case 2:return"then"in t?[4,t]:[3,4];case 3:u=b.sent(),b.label=4;case 4:return c=e,this._updateGeoJsonOptions(c),p=this.options,l=p.maxZoom,f=p.minZoom,e=x({id:String(a),order:s,maxZoom:l,minZoom:f},e),h=null===(o=e.visibility)||void 0===o||o,e.visibility=!1,e.baselayer&&(e.order=0),this.options.onBeforeAddLayer&&(d=this.options.onBeforeAddLayer({options:e,adapter:u}))&&(d.options&&(e=d.options),d.adapter&&(u=d.adapter)),void 0===u?[3,12]:((y=new u(this.mapAdapter.map,e)).options=x(x({},e),y.options),y.options.baselayer&&(e.baselayer=!0,e.order=0,y.options.order=0),v=void 0,y.options.id&&(v=String(y.options.id),this._layers[v]=y),this.emitter.emit("layer:preadd",y),[4,this.onMapLoad()]);case 5:return b.sent(),[4,y.addLayer(y.options)];case 6:if(m=b.sent(),y.layer=m,y.id=y.options.id||String(a),y.options.id=y.id,e.baselayer&&(y.options.order=0),y.order=null!==(i=y.options.order)&&void 0!==i?i:s,v&&delete this._layers[v],v=String(y.id),this._layers[v])throw Error("layer with id '"+v+"' already exist");return v?(this._layers[v]=y,c.filter&&this.filterLayer(y,c.filter),e.baselayer&&this._baselayers.push(v),h?[4,this.showLayer(v)]:[3,8]):[3,8];case 7:b.sent(),b.label=8;case 8:return void 0!==(_=e.opacity)&&_<=1&&this.setLayerOpacity(y,_),e.fit&&y.getExtent?[4,y.getExtent()]:[3,11];case 9:return(g=b.sent())?[4,this.fitBounds(g)]:[3,11];case 10:b.sent(),b.label=11;case 11:return this.emitter.emit("layer:add",y),[2,y];case 12:return[2,Promise.reject("No adapter")]}}))}))},e.prototype.addLayerFromAsyncAdapter=function(t,e,r){return F(this,void 0,void 0,(function(){var n,o;return j(this,(function(i){switch(i.label){case 0:return n=r||void 0!==e.order?e.order:this.reserveOrder(),[4,t()];case 1:return(o=i.sent())?[2,this.addLayer(o,e,n)]:[2,Promise.reject("No adapter")]}}))}))},e.prototype.removeLayers=function(t){for(var e in this._layers){var r=!0;t&&(r=t(e,this._layers[e])),r&&(this.removeLayer(e),delete this._layers[e])}},e.prototype.reserveOrder=function(){return this._layersOrderCounter++},e.prototype.removeOverlays=function(){this.removeLayers((function(t,e){return!(e&&e.options&&e.options.baselayer)}))},e.prototype.removeLayer=function(t){var e=this.getLayer(t),r=e&&this.getLayerId(e);if(e&&r){if(this.emitter.emit("layer:preremove",e),e.beforeRemove&&e.beforeRemove(),e.removeLayer?e.removeLayer():this.mapAdapter.removeLayer(e.layer),e.options&&e.options.baselayer){var n=this._baselayers.indexOf(r);n&&this._baselayers.splice(n,1)}delete this._layers[r],this.emitter.emit("layer:remove",e)}},e.prototype.addGeoJsonLayer=function(t,e){return F(this,void 0,void 0,(function(){var r;return j(this,(function(n){switch(n.label){case 0:return(t=t||{}).multiselect=void 0!==t.multiselect&&t.multiselect,t.unselectOnSecondClick=void 0===t.unselectOnSecondClick||t.unselectOnSecondClick,e||(t=u(t)),t.paint=t.paint||{},[4,this.addLayer(e||"GEOJSON",t)];case 1:return r=n.sent(),this.showLayer(r),[2,r]}}))}))},e.prototype.showLayer=function(t,e){return void 0===e&&(e={}),this.toggleLayer(t,!0,e)},e.prototype.hideLayer=function(t,e){return void 0===e&&(e={}),this.toggleLayer(t,!1,e)},e.prototype.toggleLayer=function(t,e,r){var n=this;void 0===r&&(r={});var o=this.getLayer(t),i=o&&o.options.visibility,a=void 0!==e?e:!i,s=void 0!==r.silent&&r.silent;return o&&o.options.visibility!==a?this.onMapLoad().then((function(){return function(t,e){var r=a?"layer:preshow":"layer:prehide",o=a?"layer:show":"layer:hide";if(s||n.emitter.emit(r,e),a&&t){var i=e.options.baselayer?0:e.options.order;if(e.options.baselayer&&n._baselayers.length){var u=n._baselayers.find((function(t){return t!==e.id&&n.isLayerVisible(t)}));u&&n.hideLayer(u)}e.showLayer?e.showLayer.call(e,e.layer):void 0!==e.layer&&n.mapAdapter.showLayer(e.layer),void 0!==i&&n.mapAdapter.setLayerOrder(e.layer,i,n._layers)}else e.hideLayer?e.hideLayer.call(e,e.layer):void 0!==e.layer&&n.mapAdapter.hideLayer(e.layer);s||n.emitter.emit(o,e),e.options.visibility=a}(n.mapAdapter,o)})):Promise.resolve()},e.prototype.updateLayer=function(t){var e=this.getLayer(t);e&&(e.updateLayer?e.updateLayer():this.isLayerVisible(e)&&(this.hideLayer(e,{silent:!0}),this.showLayer(e,{silent:!0})))},e.prototype.setLayerOpacity=function(t,e){var r=this.getLayer(t);r&&this.mapAdapter.setLayerOpacity&&r&&this.mapAdapter.setLayerOpacity(r.layer,e)},e.prototype.selectLayer=function(t,e){var r=this.getLayer(t);if(r){var n=r;n&&n.select&&n.select(e);var o=this.getLayerId(r);o&&this._selectedLayers.push(o)}},e.prototype.unSelectLayer=function(t,e){var r=this.getLayer(t);if(r){var n=r&&r;n.unselect&&n.unselect(e);var o=this.getLayerId(r);if(o){var i=this._selectedLayers.indexOf(o);-1!==i&&this._selectedLayers.splice(i,1)}}},e.prototype.filterLayer=function(t,e){var r=this.getLayer(t);return r.filter?r.filter(e):[]},e.prototype.propertiesFilter=function(t,e,r){var n=this.getLayer(t);n.propertiesFilter?n.propertiesFilter(e,r):n.filter&&this.filterLayer(n,(function(t){return!t.feature||!t.feature.properties||Object(p.c)(t.feature.properties,e)}))},e.prototype.removeLayerFilter=function(t){var e=this.getLayer(t);e.removeFilter?e.removeFilter():e.filter&&e.filter((function(){return!0}))},e.prototype.setLayerData=function(t,e){var r=this.getLayer(t);r&&(r.setData?r.setData(e):r.clearLayer&&r.addData&&(r.clearLayer(),r.addData(e)))},e.prototype.addLayerData=function(t,e){var r=this.getLayer(t);r.addData&&r.addData(e)},e.prototype.clearLayerData=function(t,e){var r=this.getLayer(t);r&&r.clearLayer&&r.clearLayer(e)},e.prototype.getAttributions=function(t){var e=[];for(var r in this._layers){var n=this._layers[r],o=!(void 0===t.onlyVisible||t.onlyVisible)||n.options.visibility;if(o&&t.onlyBaselayer&&(o=this._baselayers.includes(r)),o){var i=n.options&&n.options.attribution;i&&e.push(i)}}return e},e.prototype.getActiveBaseLayer=function(){var t=this,e=this.getBaseLayers().find((function(e){return t.isLayerVisible(e)}));if(e)return this.getLayer(e)},e.prototype._onLayerClick=function(t){return F(this,void 0,void 0,(function(){return j(this,(function(e){return this.emitter.emit("layer:click",t),[2,Promise.resolve(t)]}))}))},e.prototype._onLayerSelect=function(t){return F(this,void 0,void 0,(function(){return j(this,(function(e){return this.emitter.emit("layer:select",t),[2,Promise.resolve(t)]}))}))},e.prototype._updateGeoJsonOptions=function(t){var e=this,r=t.onLayerClick;t.onLayerClick=function(t){return r&&r(t),e._onLayerClick(t)};var o=t.onLayerSelect;t.onLayerSelect=function(t){return o&&o(t),e._onLayerSelect(t)},t.nativePaint||(this.options.paint&&(t.paint=Object(n.preparePaint)(t.paint||{},this.options.paint,this.getPaintFunctions)),t.selectedPaint&&this.options.selectedPaint&&(t.selectedPaint=Object(n.preparePaint)(t.selectedPaint,this.options.selectedPaint,this.getPaintFunctions)))},e}(A),T=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),M=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},N=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._loadControlQueue={"top-right":[],"bottom-right":[],"top-left":[],"bottom-left":[]},e._isControlLoading={"top-right":!1,"bottom-right":!1,"top-left":!1,"bottom-left":!1},e}return T(e,t),e.prototype.addControl=function(t,e,r){return M(this,void 0,void 0,(function(){var n,o=this;return N(this,(function(i){return e=null!=e?e:"top-left",(n="string"==typeof t?this.getControl(t,r):t)?[2,new Promise((function(t){o._setControlQueue(e,(function(){return M(o,void 0,void 0,(function(){var r,o;return N(this,(function(i){switch(i.label){case 0:return[4,n];case 1:return r=i.sent(),o=this.mapAdapter.addControl(r,e),t(o),[2]}}))}))}))}))]:[2]}))}))},e.prototype.createControl=function(t,e){return M(this,void 0,void 0,(function(){return N(this,(function(r){switch(r.label){case 0:return[4,this.onLoad("build-map")];case 1:return r.sent(),this.mapAdapter.createControl?[2,this.mapAdapter.createControl(t,e)]:[2]}}))}))},e.prototype.createButtonControl=function(t){return M(this,void 0,void 0,(function(){return N(this,(function(e){switch(e.label){case 0:return[4,this.onLoad("build-map")];case 1:return e.sent(),this.mapAdapter.createButtonControl?[2,this.mapAdapter.createButtonControl(t)]:[2]}}))}))},e.prototype.createToggleControl=function(t){return M(this,void 0,void 0,(function(){return N(this,(function(e){switch(e.label){case 0:return[4,this.onLoad("build-map")];case 1:return e.sent(),this.mapAdapter.createToggleControl?[2,this.mapAdapter.createToggleControl(t)]:this.mapAdapter.createButtonControl?[2,b(this.mapAdapter.createButtonControl,t)]:[2]}}))}))},e.prototype.removeControl=function(t){"remove"in t?t.remove():this.mapAdapter.removeControl&&this.mapAdapter.removeControl(t)},e.prototype.getControl=function(t,r){var n=this.mapAdapter.controlAdapters[t];if(n)return new n(r);var o=e.controls[t];return o?o(this,r):void 0},e.prototype._setControlQueue=function(t,e){this._loadControlQueue[t].push(e),this._isControlLoading[t]||this._applyControls(t)},e.prototype._applyControls=function(t){return M(this,void 0,void 0,(function(){return N(this,(function(e){switch(e.label){case 0:return this._loadControlQueue[t].length?(this._isControlLoading[t]=!0,[4,(0,this._loadControlQueue[t][0])()]):[3,2];case 1:return e.sent(),this._loadControlQueue[t].splice(0,1),this._applyControls(t),[3,3];case 2:this._isControlLoading[t]=!1,e.label=3;case 3:return[2]}}))}))},e.controls={CONTROL:function(t,e){return t.createControl(e.control,e.options)},BUTTON:function(t,e){return t.createButtonControl(e)},TOGGLE:function(t,e){return t.createToggleControl(e)}},e}(I),B=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),z=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},D=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},Z=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,r=t[Symbol.asyncIterator];return r?r.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(r){e[r]=t[r]&&function(e){return new Promise((function(n,o){(function(t,e,r,n){Promise.resolve(n).then((function(e){t({value:e,done:r})}),e)})(n,o,(e=t[r](e)).done,e.value)}))}}},q=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return B(e,t),e.prototype._addLayerProviders=function(){var t,e,r,n;return z(this,void 0,void 0,(function(){var o,i,a,s,u,c,p,l,f,h,d;return D(this,(function(y){switch(y.label){case 0:y.trys.push([0,26,,27]),y.label=1;case 1:y.trys.push([1,19,20,25]),o=Z(this._starterKits),y.label=2;case 2:return[4,o.next()];case 3:return(i=y.sent()).done?[3,18]:(a=i.value).getLayerAdapters?[4,a.getLayerAdapters.call(a)]:[3,17];case 4:if(!(s=y.sent()))return[3,17];y.label=5;case 5:y.trys.push([5,11,12,17]),r=void 0,u=Z(s),y.label=6;case 6:return[4,u.next()];case 7:return(c=y.sent()).done?[3,10]:[4,(p=c.value).createAdapter(this)];case 8:(l=y.sent())&&(this.mapAdapter.layerAdapters[p.name]=l),y.label=9;case 9:return[3,6];case 10:return[3,17];case 11:return f=y.sent(),r={error:f},[3,17];case 12:return y.trys.push([12,,15,16]),c&&!c.done&&(n=u.return)?[4,n.call(u)]:[3,14];case 13:y.sent(),y.label=14;case 14:return[3,16];case 15:if(r)throw r.error;return[7];case 16:return[7];case 17:return[3,2];case 18:return[3,25];case 19:return h=y.sent(),t={error:h},[3,25];case 20:return y.trys.push([20,,23,24]),i&&!i.done&&(e=o.return)?[4,e.call(o)]:[3,22];case 21:y.sent(),y.label=22;case 22:return[3,24];case 23:if(t)throw t.error;return[7];case 24:return[7];case 25:return[3,27];case 26:throw d=y.sent(),new Error(d);case 27:return[2]}}))}))},e.prototype._onLoadSync=function(){var t,e;return z(this,void 0,void 0,(function(){var r,n,o,i,a;return D(this,(function(s){switch(s.label){case 0:s.trys.push([0,8,9,14]),r=Z(this._starterKits),s.label=1;case 1:return[4,r.next()];case 2:if((n=s.sent()).done)return[3,7];if(!(o=n.value).onLoadSync)return[3,6];s.label=3;case 3:return s.trys.push([3,5,,6]),[4,o.onLoadSync.call(o,this)];case 4:return s.sent(),[3,6];case 5:return i=s.sent(),console.error(i),[3,6];case 6:return[3,1];case 7:return[3,14];case 8:return a=s.sent(),t={error:a},[3,14];case 9:return s.trys.push([9,,12,13]),n&&!n.done&&(e=r.return)?[4,e.call(r)]:[3,11];case 10:s.sent(),s.label=11;case 11:return[3,13];case 12:if(t)throw t.error;return[7];case 13:return[7];case 14:return[2]}}))}))},e}(R)},151:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n=/\{ *([\w_-]+) *\}/g;function o(t,e){return t.replace(n,(function(t,r){var n=e[r];if(void 0===n)throw new Error("No value provided for letiable "+t);return"function"==typeof n&&(n=n(e)),n}))}},233:function(t,e,r){"use strict";(function(t){"undefined"!=typeof window&&window.document}).call(this,r(92))},234:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(t){this.emitter=t,this._eventsStatus={}}return t.prototype.setEventStatus=function(t,e){this._eventsStatus[t]=e},t.prototype.onLoad=function(t){var e=this,r=(Array.isArray(t)?t:[t]).map((function(t){return new Promise((function(r){if(e.getEventStatus(t))r(e);else{var n=t;e.emitter.once(n,(function(){e.setEventStatus(t,!0),r(e)}))}}))}));return Promise.all(r).then((function(){return e}))},t.prototype.getEventStatus=function(t){var e=t,r=this._eventsStatus[e];return void 0!==r&&!!r},t}()},235:function(t,e,r){"use strict";function n(t){return t.replace(/([^:]\/)\/+/g,"$1")}r.d(e,"a",(function(){return n}))},236:function(t,e,r){"use strict";function n(t){return void 0===t&&(t=0),new Promise((function(e){return setTimeout(e,t)}))}r.d(e,"a",(function(){return n}))},237:function(t,e,r){"use strict";function n(t){return null!=t}r.d(e,"a",(function(){return n}))},238:function(t,e,r){"use strict";var n=r(239);r.o(n,"Clipboard")&&r.d(e,"Clipboard",(function(){return n.Clipboard})),r.o(n,"debounce")&&r.d(e,"debounce",(function(){return n.debounce})),r.o(n,"deepmerge")&&r.d(e,"deepmerge",(function(){return n.deepmerge})),r.o(n,"mixinProperties")&&r.d(e,"mixinProperties",(function(){return n.mixinProperties}));var o=r(240);r.o(o,"Clipboard")&&r.d(e,"Clipboard",(function(){return o.Clipboard})),r.o(o,"debounce")&&r.d(e,"debounce",(function(){return o.debounce})),r.o(o,"deepmerge")&&r.d(e,"deepmerge",(function(){return o.deepmerge})),r.o(o,"mixinProperties")&&r.d(e,"mixinProperties",(function(){return o.mixinProperties}))},239:function(t,e){},240:function(t,e){},241:function(t,e,r){"use strict";function n(t,e,r){r.forEach((function(r){var n=Object.getOwnPropertyDescriptor(e.prototype,r);n&&Object.defineProperty(t.prototype,r,n)}))}r.d(e,"a",(function(){return n}))},242:function(t,e,r){"use strict";function n(t,e,r){void 0===r&&(r=!1);var o=t,i=e,a=Array.isArray(i),s=a&&[]||{};return a&&Array.isArray(i)?r?(o=o||[],s=s.concat(o),i.forEach((function(t,e){void 0===s[e]?s[e]=t:"object"==typeof t?s[e]=n(o[e],t,r):-1===o.indexOf(t)&&s.push(t)}))):s=i:(o&&"object"==typeof o&&Object.keys(o).forEach((function(t){s[t]=o[t]})),Object.keys(i).forEach((function(t){"object"==typeof i[t]&&i[t]&&"object"==typeof o[t]&&"object"==typeof i[t]?s[t]=n(o[t],i[t],r):s[t]=i[t]}))),s}r.d(e,"a",(function(){return n}))},243:function(t,e,r){"use strict";function n(t,e){void 0===e&&(e=10);var r=0;return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];clearTimeout(r),r=window.setTimeout((function(){return t.apply(void 0,n)}),e)}}r.d(e,"a",(function(){return n}))},244:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(t){this.silent=!0,t&&this.copy(t)}return t.copy=function(e){return new t(e)},t.prototype.copy=function(t){try{navigator.clipboard?navigator.clipboard.writeText(t):window.clipboardData?window.clipboardData.setData("text",t):this.copyToClipboard(t),!this.silent&&console.log("Copied to Clipboard")}catch(t){!this.silent&&console.log("Please copy coupon manually")}},t.prototype.copyToClipboard=function(t){var e=document.createElement("input");e.value=t;try{document.body.appendChild(e),this.copyNodeContentsToClipboard(e)}finally{document.body.removeChild(e)}},t.prototype.copyNodeContentsToClipboard=function(t){t.select(),t.setSelectionRange(0,99999),document.execCommand("copy")},t}()},245:function(t,e){},246:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));var n=r(37),o=r(49),i=r(112),a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function s(t,e,r){var u;if(Object(o.d)(t)){var c=function(n){var o=s(t(n),e,r);return o.type=t.type,o};return c.type=t.type,c}if(Object(o.e)(t))return function(o){return s((i={},u=[],t.forEach((function(t){t&&(Array.isArray(t)?u.push(t):i=t)})),function(t){var e=u.find((function(e){return Object(n.b)(t,e[0])}));return e?a(a({},i),e[1]):i})(o),e,r);var i,u};if("get-paint"===t.type){var p=function(t,e){if("function"==typeof t.from)return t.from(t.options);if("string"==typeof t.from&&e){var r=e[t.from];if(r)return r(t.options)}}(t,r);p&&(u=s(p,e,r))}else{if("icon"===t.type)return t;var l=Object(i.a)(t);if(l)return function(t){return s(l(t),e,r)};(u=a({},t)).fill=void 0===u.fill||u.fill,u.stroke=void 0!==u.stroke?u.stroke:!u.fill||!(!u.strokeColor&&!u.strokeOpacity)}if(u){if(Object(o.d)(u))return u;Object(o.c)(u)&&(u=a(a({},e),u))}else u=a({},e);return"color"in u&&(u.strokeColor||(u.strokeColor=u.color),u.fillColor||(u.fillColor=u.color)),"opacity"in u&&(void 0===u.strokeOpacity&&(u.strokeOpacity=u.opacity),void 0===u.fillOpacity&&(u.fillOpacity=u.opacity)),u}},247:function(t,e){},248:function(t,e){},249:function(t,e){},250:function(t,e){},251:function(t,e){},252:function(t,e){},253:function(t,e,r){"use strict";r(37)},254:function(t,e){},255:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(88),o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},i=function(){function t(t){this.options={url:"https://qms.nextgis.com"},this.options=o(o({},this.options),t),this.url=this.options.url}return t.prototype.getLayerAdapters=function(){var t=this;return Promise.resolve([{name:"QMS",createAdapter:function(e){return Promise.resolve(t._createAdapter(e))}}])},t.prototype._createAdapter=function(t){return Object(n.a)(t,this.url)},t.utils={createQmsAdapter:n.a},t}()},256:function(t,e){},260:function(t,e){},261:function(t,e){},262:function(t,e){},263:function(t,e){},264:function(t,e){},267:function(t,e){},268:function(t,e,r){"use strict";function n(t){return t.filter((function(t,e,r){return r.indexOf(t)==e}))}r.d(e,"a",(function(){return n}))},269:function(t,e,r){"use strict";function n(t){var e=t.toString().split(".");return e[0]=e[0].replace(/\B(?=(\d{3})+(?!\d))/g," "),e.join(".")}r.d(e,"a",(function(){return n}))},270:function(t,e,r){"use strict"},271:function(t,e,r){"use strict";function n(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}r.d(e,"a",(function(){return n}))},273:function(t,e,r){"use strict";var n=r(148);r.d(e,"WebMap",(function(){return n.a}));r(247),r(248),r(249),r(250),r(251),r(252),r(253),r(254)},274:function(t,e,r){"use strict";var n=r(255);r.d(e,"QmsKit",(function(){return n.a}));r(256),r(88),r(87)},280:function(t,e,r){"use strict";var n=r(281);r(260),r(261),r(262),r(263),r(264);e.default=n.a},281:function(t,e,r){"use strict";(function(t){r.d(e,"a",(function(){return m}));var n=r(41),o=r(11),i=r(23),a=r(300),s=r(151),u=r(282),c=r(283),p=r(119),l=r(50),f=r(113),h=r(284),d=function(){return(d=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},y=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},v="undefined"!=typeof window&&void 0!==window.document,m=function(){function e(t){this.options=t,this.emitter=new i.EventEmitter,this.routeStr="/api/component/pyramid/route",this._loadingQueue={},this._loadingStatus={},this._queriesCache={},this._resourcesCache={},this.options.route&&(this.routeStr=this.options.route)}return e.prototype.setNgw=function(t){this.logout(),this.options.baseUrl=t},e.prototype.setNextGisWeb=function(t){this.setNgw(t)},e.prototype.connect=function(){var t=this;return new n.a((function(e,r){var n=function(){return t.makeQuery(t.routeStr,{},{}).then((function(r){t.route=r,e(r)})).catch(r)};if(t.route)return e(t.route);if(t.options.auth){var o=t.options.auth,i=o.login,a=o.password;if(i&&a)return t.getUserInfo({login:i,password:a}).then((function(){return n()}))}n()}))},e.prototype.login=function(t){return this.logout(),this.getUserInfo(t)},e.prototype.logout=function(){this._rejectLoadingQueue(),this._loadingStatus={},this.options.auth=void 0,this.route=void 0,this.user=void 0,this.emitter.emit("logout")},e.prototype.getUserInfo=function(t){var e=this;if(this.user&&this.user.id)return n.a.resolve(this.user);t&&(this.options.auth=t);var r={headers:this.getAuthorizationHeaders(t)};return this.makeQuery("/api/component/auth/current_user",{},r).then((function(t){return e.user=t,e.emitter.emit("login",t),t})).catch((function(t){throw e.emitter.emit("login:error",t),t}))},e.prototype.getAuthorizationHeaders=function(t){var e=this.makeClientId(t);if(e)return{Authorization:"Basic "+e}},e.prototype.makeClientId=function(e){if(e=e||this.options.auth){var r=e.login,n=e.password,o=unescape(encodeURIComponent(r+":"+n));return v?window.btoa(o):t.from(o).toString("base64")}},e.prototype.apiRequest=function(t,e,r){var o=this;return void 0===e&&(e={}),new n.a((function(n,i){o.connect().then((function(a){var u=a&&a[t];if(u){var c=(u=y(u)).shift();if(u.length){for(var p={},l=0;l<u.length;l++){var f=u[l];if(p[l]="{"+f+"}",void 0===e[f])throw new Error("`"+f+"` url api argument is not specified")}c&&(c=Object(s.a)(c,p))}if(e){var h=[],d=e.paramList;for(var v in Array.isArray(d)&&(delete e.paramList,d.forEach((function(t){h.push(t[0]+"="+t[1])}))),e)-1===u.indexOf(v)&&h.push(v+"="+e[v]);h.length&&(c=c+"?"+h.join("&"))}if(c)return o.makeQuery(c,e,r).then((function(t){n(t)})).catch(i);i(new Error("request url is not set"))}else n({})}))}))},e.prototype.post=function(t,e,r){return(e=e||{}).method="POST",e.nocache=!0,this.apiRequest(t,r,e)},e.prototype.get=function(t,e,r){return(e=e||{}).method="GET",e.nocache=!0,this.apiRequest(t,r,e)},e.prototype.patch=function(t,e,r){return(e=e||{}).method="PATCH",e.nocache=!0,this.apiRequest(t,r,e)},e.prototype.put=function(t,e,r){return(e=e||{}).method="PUT",e.nocache=!0,this.apiRequest(t,r,e)},e.prototype.delete=function(t,e,r){return(e=e||{}).method="DELETE",e.nocache=!0,this.apiRequest(t,r,e)},e.prototype.makeQuery=function(t,e,r){var o=this;if(void 0===r&&(r={}),t=(this.options.baseUrl?this.options.baseUrl:"")+t)return e&&(t=Object(s.a)(t,e)),t=t.replace(/([^:]\/)\/+/g,"$1"),r.cache&&this._queriesCache[t]?this._queriesCache[t]:!this._loadingStatus[t]||r.nocache?(this._loadingStatus[t]=!0,this._loadData(t,r).then((function(e){return o._loadingStatus[t]=!1,r.cache&&(o._queriesCache[t]=e),o._executeLoadingQueue(t,e),e})).catch((function(e){throw o._loadingStatus[t]=!1,o._executeLoadingQueue(t,e,!0),o.emitter.emit("error",e),e}))):(this._loadingStatus[t]=!1,new n.a((function(e,r){o._setLoadingQueue(t,e,r)})));throw new Error("No `url` parameter set for option "+name)},e.prototype.getResource=function(t){return"string"==typeof t?this.getResourceByKeyname(t):"number"==typeof t?this.getResourceById(t):Object(f.a)(t)?this.getResourceBy(t):n.a.resolve(void 0)},e.prototype.getResourceId=function(t){return"number"==typeof t?n.a.resolve(t):"string"==typeof t?this.getResourceByKeyname(t).then((function(t){if(t)return t.resource.id})):n.a.resolve(void 0)},e.prototype.getResourcesBy=function(t){var e=this,r=[];if(t.id){var o=this._resourcesCache[t.id];o&&r.push(o)}else r=this._resourceCacheFilter(t);if(!r.length){var i={};return t.keyname?i.keyname=t.keyname:Object.assign(i,Object(u.a)(t)),this.get("resource.search",null,d({serialization:"full"},i)).then((function(t){return t&&t.forEach((function(t){e._resourcesCache[t.resource.id]=t})),t})).catch((function(){return[]}))}return n.a.resolve(r)},e.prototype.getResourceBy=function(t){return this.getResourcesBy(t).then((function(t){return t[0]}))},e.prototype.getResourceByKeyname=function(t){return this.getResourceBy({keyname:t})},e.prototype.getResourceById=function(t){var e=this,r=this._resourcesCache[t];return r?n.a.resolve(r):this.get("resource.item",null,{id:t}).then((function(r){return r&&(e._resourcesCache[t]=r),r})).catch((function(t){if(!(t instanceof p.a))throw t}))},e.prototype.getResourceChildren=function(t){var e=this,r={};"string"==typeof t?r.keyname=t:"number"==typeof t?r.resourceId=t:r=t;var n=r.resourceId,o=r.keyname;if(!r.keyname&&!r.resourceId&&!r.resource)throw new Error("No keyname or resourceId is set");r.resource&&("string"==typeof r.resource?o=r.resource:"number"==typeof r.resource&&(n=r.resource));var i=function(){return e.get("resource.collection",null,{parent:n})};return o?this.getResourceByKeyname(o).then((function(t){return t&&(n=t.resource.id),i()})):i()},e.prototype.deleteResource=function(t){var e=this;return this.getResourceId(t).then((function(t){if(void 0!==t)return e.delete("resource.item",null,{id:t}).then((function(){delete e._resourcesCache[t]}))}))},e.prototype._setLoadingQueue=function(t,e,r){this._loadingQueue[t]=this._loadingQueue[t]||{name:t,waiting:[]},this._loadingQueue[t].waiting.push({resolve:e,reject:r,timestamp:new Date})},e.prototype._rejectLoadingQueue=function(){for(var t in this._loadingQueue){this._loadingQueue[t].waiting.forEach((function(t){t.reject()})),delete this._loadingQueue[t]}},e.prototype._executeLoadingQueue=function(t,e,r){var n=this._loadingQueue[t];if(n){for(var o=0;o<n.waiting.length;o++){var i=n.waiting[o];r?i.reject&&i.reject():i.resolve(e)}n.waiting=[]}},e.prototype._loadData=function(t,e){var r=this;return e.responseType=e.responseType||"json",new n.a((function(n,o,i){r.user&&((e=e||{}).headers=d(d({},r.getAuthorizationHeaders()),e.headers)),Object(a.a)(t,n,e,o,i)})).catch((function(t){var e=r._handleHttpError(t);if(e)throw e}))},e.prototype._handleHttpError=function(t){if(t&&t instanceof l.a){if("nextgisweb.resource.exception.ResourceNotFound"===t.exception)throw new p.a(t);if("nextgisweb.core.exception.InsufficientPermissions"===t.exception)throw new h.a(t)}return t},e.prototype._resourceCacheFilter=function(t){return Object.values(this._resourcesCache).filter((function(e){return t.keyname&&e.resource.keyname?t.keyname===e.resource.keyname:Object(o.defined)(t.id)&&Object(o.defined)(e.resource.id)?t.id===e.resource.id:Object(c.a)(t,e.resource)}))},e.errors={NgwError:l.a,ResourceNotFoundError:p.a},e}()}).call(this,r(503).Buffer)},282:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n=r(11),o=r(113);function i(t,e){void 0===e&&(e=""),e=e?e+"__":"";var r={};return Object.entries(t).forEach((function(t){var a=t[0],s=t[1];if(Object(o.a)(s)){var u=i(s,a);Object.assign(r,u)}else Object(n.defined)(s)&&(r[e+a]=s)})),r}},283:function(t,e,r){"use strict";function n(t,e){return function t(e,r){return Object.entries(e).every((function(e){var n=e[0],i=e[1],a=r[n];return o(i)?!!o(a)&&t(i,a):void 0===a||i===a}))}(t,e)}function o(t){return"[object Object]"===Object.prototype.toString.call(t)}r.d(e,"a",(function(){return n}))},284:function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n,o=r(50),i=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),a=function(t){function e(r){var n=t.call(this,r)||this;return n.name="InsufficientPermissionsError",n.exception="nextgisweb.core.exception.InsufficientPermissions",Object.setPrototypeOf(n,e.prototype),n}return i(e,t),e}(o.a)},286:function(t,e,r){"use strict";var n=r(287);r(267);e.default=n.a},287:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));var n=function(){function t(){this._params={}}return t.prototype.get=function(t){return this.params()[t]},t.prototype.params=function(){var t={};return window.location.href.replace(/[?&]+(\w+)([^&]*)/gi,(function(e,r){return t[r]=!0,""})),window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,(function(e,r,n){return t[r]=decodeURIComponent(n),""})),this._params=t,t},t.prototype.set=function(t,e){if(e){var r=void 0,n=encodeURIComponent(e);r=this.get(t)?location.search.replace(new RegExp("([?|&]"+t+"=)(.+?)(&|$)"),"$1"+n+"$3"):location.search.length?location.search+"&"+t+"="+n:"?"+t+"="+n;var o={};o[t]=e,this._params[t]=e;var i={state:{url:r,params:o},url:r};return this._pushState(i),i}return this.remove(t)},t.prototype.remove=function(t){var e,r=location.search,n=r.split("?")[0],o=-1!==r.indexOf("?")?r.split("?")[1]:"";if(""!==o){for(var i=(e=o.split("&")).length-1;i>=0;i-=1)e[i].split("=")[0]===t&&e.splice(i,1);n=n+"?"+e.join("&")}delete this._params[t];var a={state:{url:n,type:"remove"},url:n};return this._pushState(a),a},t.prototype._pushState=function(t){history&&history.replaceState(t.state,document.title,t.url)},t}()},296:function(t,e,r){"use strict";var n,o=r(11),i=r(56),a=r(37);try{n=r(490)}catch(t){}function s(t,e){var r=window.document.createElement("canvas"),o=r.getContext("2d");if(!o)throw new Error("failed to create canvas 2d context");if(r.setAttribute("width",String(e.width)),r.setAttribute("height",String(e.height)),!n&&t instanceof HTMLImageElement)o.drawImage(t,0,0,e.width,e.height);else if("string"==typeof t){if(n.Canvg)n.Canvg.fromString(o,t).start();else n(r,t)}return o.getImageData(0,0,e.width,e.height)}var u=0,c=function(){function t(t,e){this.options=e,this.map=t,this._layerId="layer-"+u++}return t.prototype.beforeRemove=function(){Object.assign(this,{map:void 0})},t}(),p={point:[["fillColor","color"],["fillOpacity","opacity"],["strokeColor","stroke-color"],["strokeOpacity","stroke-opacity"],["weight","stroke-width"],"radius"],line:[["strokeColor","color"],["strokeOpacity","opacity"],["weight","width"]],polygon:[["fillColor","color"],["fillOpacity","opacity"]]},l={Point:"point",LineString:"line",MultiPoint:"point",Polygon:"polygon",MultiLineString:"line",MultiPolygon:"polygon",GeometryCollection:"polygon"},f={point:"Point",line:"LineString",polygon:"Polygon"},h={};for(var d in l){var y=l[d],v=h[y]||[];v.push(d),h[y]=v}function m(t){for(var e={},r=0;r<t.length;r++)e[t[r]]=1+(e[t[r]]||0);var n="";for(var o in e){var i=n?e[n]:0;e[o]>i&&(n=o)}return n}function _(t,e){var r=h[e];return!!r&&-1!==r.indexOf(t)}var g,b=(g=function(t,e){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}g(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),w=function(){return(w=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},L=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},O=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},P=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},C={gt:">",lt:"<",ge:">=",le:"<=",eq:"==",ne:"!=",in:"in",notin:"!in",like:"==",ilike:"=="},E={gt:C.le,lt:C.ge,ge:C.lt,le:C.gt,eq:C.ne,ne:C.eq,in:C.notin,notin:C.in,like:C.ne,ilike:C.ne},S={color:"blue",opacity:1,radius:10},A={polygon:"fill",line:"line",point:"circle"},k=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.options=r,n.selected=!1,n.featureIdName="id",n._types=["polygon","point","line"],n._selectedFeatureIds=[],n._sourceId=n.options.source?n.options.source:"source-"+n._layerId,n.options.featureIdName?n.featureIdName=n.options.featureIdName:n.options.source?n.featureIdName="$id":n.featureIdName="fid",n._selectionName=n._layerId+"-highlighted",n.$onLayerMouseLeave=n._onLayerMouseLeave.bind(n),n.$onLayerMouseMove=n._onLayerMouseMove.bind(n),n.options.selectable&&n.map._onMapClickLayers.push(n),n}return b(e,t),e.prototype.addLayer=function(t){return L(this,void 0,void 0,(function(){var e,r,n,o,i,a,s,u,c;return O(this,(function(p){switch(p.label){case 0:if(t=this.options=w(w({},this.options),t||{}),this.layer=[],e=this._types=t.type?[t.type]:this._types,!t.paint)return[3,5];this._onAddLayer(this._sourceId),r=0,n=e,p.label=1;case 1:return r<n.length?(o=n[r],(i=f[o])?(a=o,"point"===o&&"icon"===this._detectPaintType(t.paint)&&(a="point"),s=this._getLayerNameFromType(o),u=e.length>1?["==","$type",i]:void 0,[4,this._addLayer(s,a,[u,this._getNativeFilter()])]):[3,4]):[3,5];case 2:return p.sent(),this.layer.push(s),t.selectedPaint?(c=this._getSelectionLayerNameFromType(o),[4,this._addLayer(c,a,[u,["in",this.featureIdName,""]],this.options.selectedLayout)]):[3,4];case 3:p.sent(),this.layer.push(c),p.label=4;case 4:return r++,[3,1];case 5:return this._addEventsListeners(),[2,this.layer]}}))}))},e.prototype.propertiesFilter=function(t,e){this._filterProperties=t,this._updatePropertiesFilter()},e.prototype.removeFilter=function(){this._filterProperties=void 0,this._updateFilter()},e.prototype.select=function(t){"function"!=typeof t&&(this._selectProperties=t,this._updateFilter()),this.selected=!0,this.options.onLayerSelect&&this.options.onLayerSelect({layer:this,features:[]})},e.prototype.unselect=function(){this._selectProperties=void 0,this._updateFilter(),this.selected=!1,this.options.onLayerSelect&&this.options.onLayerSelect({layer:this,features:void 0})},e.prototype.beforeRemove=function(){var e=this.map;if(e){this.layer&&this.layer.forEach((function(t){e.removeLayer(t)}));var r=e._onMapClickLayers.indexOf(this);-1!==r&&this.map._onMapClickLayers.splice(r,1)}this._removeEventListeners(),this.$onLayerMouseLeave=void 0,this.$onLayerMouseMove=void 0,t.prototype.beforeRemove.call(this)},e.prototype._onLayerClick=function(t){var e;t.preventDefault();var r=this.map;if(r){if(this.layer&&(this.layer.find((function(n){var o=r.queryRenderedFeatures(t.point,{layers:[n]});return!!o.length&&(e=o[0],!0)})),e)){var n=void 0,o=this.isFeatureSelected(e);o?this.options&&this.options.unselectOnSecondClick&&this._unselectFeature(e,{silent:!0}):n=this._selectFeature(e,{silent:!0}),o=this.isFeatureSelected(e),this.options.onLayerClick&&this.options.onLayerClick({layer:this,feature:e,selected:o}),this.options.onLayerSelect&&this.options.onLayerSelect({layer:this,features:n})}return e}},e.prototype._updateWithNativeFilter=function(t){var e=this._getNativeFilter();return e.length&&t.push(e),t},e.prototype._getNativeFilter=function(){return this.options.nativeFilter?this.options.nativeFilter:[]},e.prototype._addLayer=function(t,e,r,n){return L(this,void 0,void 0,(function(){var o,i,a,s,u,c,p;return O(this,(function(l){return o=this.options,i=o.minZoom,a=o.maxZoom,this.options.paint&&"type"in this.options.paint&&"icon"===this.options.paint.type&&(s="symbol"),void 0===s&&(s=A[e]),n=n||this.options.layout||{},u=w({id:t,type:s,source:this._sourceId,layout:w({visibility:"none"},n)},this._getAdditionalLayerOptions()),this.options.nativeOptions&&Object.assign(u,this.options.nativeOptions),i&&(u.minzoom=i-1),a&&(u.maxzoom=a-1),(c=this.map)&&(c.addLayer(u),(p=P(["all"],r||[]).filter((function(t){return t}))).length>1&&c.setFilter(u.id,p)),[2]}))}))},e.prototype._onAddLayer=function(t,e){},e.prototype._updateLayerPaint=function(t){return L(this,void 0,void 0,(function(){var e,r,n,o,i,a,s,u,c,p;return O(this,(function(l){switch(l.label){case 0:if(e=this._getLayerNameFromType(t),!this.options.paint)return[3,6];r=[[e,this.options.paint]],this.options.selectedPaint&&(n=this._getSelectionLayerNameFromType(t),r.push([n,this.options.selectedPaint])),o=0,i=r,l.label=1;case 1:return o<i.length?(a=i[o],s=a[0],u=a[1],c=void 0,this.options.nativePaint?(c="boolean"==typeof this.options.nativePaint?u:this.options.nativePaint,[3,4]):[3,2]):[3,6];case 2:return[4,this._createPaintForType(u,t,s)];case 3:c=l.sent(),l.label=4;case 4:if(this.map)if("icon-image"in c)for(p in c["icon-allow-overlap"]=!0,c)this.map.setLayoutProperty(s,p,c[p]);else for(p in c)this.map.setPaintProperty(s,p,c[p]);l.label=5;case 5:return o++,[3,1];case 6:return[2]}}))}))},e.prototype._getLayerNameFromType=function(t){return t+"-"+this._layerId},e.prototype._getSelectionLayerNameFromType=function(t){return t+"-"+this._selectionName},e.prototype._createPaintForType=function(t,e,r){return L(this,void 0,void 0,(function(){var r,n,o,a,s;return O(this,(function(u){switch(u.label){case 0:return Object(i.isPaint)(t)?(r={},n=w(w({},S),t||{}),"icon"===t.type&&t.html?[4,this._registerImage(t)]:[3,2]):[3,3];case 1:return u.sent(),[2,{"icon-image":t.html}];case 2:for(s in o=A[e],a=function(t){var i=p[e];if(i){var a=i.find((function(e){return"string"==typeof e?e===t:!!Array.isArray(e)&&e[0]===t}));if(a){var s=Array.isArray(a)?a[1]:a;r[o+"-"+s]=n[t]}}},n)a(s);return r[o+"-opacity-transition"]={duration:0},[2,r];case 3:return[2]}}))}))},e.prototype._getFeatureFilterId=function(t){var e=t._featureFilterId;return void 0!==e?e:t.properties&&void 0!==t.properties[this.featureIdName]?t.properties[this.featureIdName]:t.id},e.prototype._registerImage=function(t){return L(this,void 0,void 0,(function(){var e,r,o;return O(this,(function(a){switch(a.label){case 0:return Object(i.isIcon)(t)&&t.html&&this.map?this.map.hasImage(t.html)?[3,2]:(e=12,r=12,t.iconSize&&(e=t.iconSize[0],r=t.iconSize[1]),[4,(u=t.html,c={width:e,height:r},new Promise((function(t){if(n)t(s(u,c));else{var e=new Image;e.crossOrigin="Anonymous",e.src="data:image/svg+xml;base64,"+btoa(u),e.onload=function(){var r=s(e,c);t(r)}}})))]):[3,2];case 1:o=a.sent(),this.map&&this.map.addImage(t.html,o),a.label=2;case 2:return[2]}var u,c}))}))},e.prototype._selectFeature=function(t,e){var r=this,n=Array.isArray(t)?t:[t];return this.select([[this.featureIdName,"in",n.map((function(t){return t.properties&&t.properties[r.featureIdName]||t.id}))]]),[]},e.prototype._unselectFeature=function(t,e){},e.prototype._getAdditionalLayerOptions=function(){return{}},e.prototype._updateFilter=function(){this._updatePropertiesFilter()},e.prototype._updatePropertiesFilter=function(){var t=this,e=this.layer;e&&this._types.forEach((function(r){var n=f[r];if(n){var o=["==","$type",n],i=t._getLayerNameFromType(r),a=t._getSelectionLayerNameFromType(r),s=t._selectProperties,u=t._filterProperties,c=u&&t._convertToMapboxFilter(u);if(t.map&&-1!==e.indexOf(a)&&t._selectionName){var p=[];s||t._selectedFeatureIds?(s?p=t._convertToMapboxFilter(s)||[]:t._selectedFeatureIds&&(p=[P(["in",t.featureIdName],t._selectedFeatureIds)]),c&&c.forEach((function(t){return p.push(t)})),t.map.setFilter(a,P(["all",o],p))):(p=["in","$id",""],t.map.setFilter(a,p))}if(t.map&&-1!==e.indexOf(i)){var l=["all",o];if(t._updateWithNativeFilter(l),s)t._convertToMapboxFilter(s,!0).forEach((function(t){return l.push(t)}));else t._selectedFeatureIds&&l.push(P(["!in",t.featureIdName],t._selectedFeatureIds));c&&c.forEach((function(t){return l.push(t)})),t.map.setFilter(i,l)}}}))},e.prototype._convertToMapboxFilter=function(t,e){void 0===e&&(e=!1);var r=e?E:C;return t.map((function(t){if("string"==typeof t)return t;if(Object(a.a)(t)){var e=t[0],n=t[1],o=t[2],i=r[n];return"in"===n||"notin"===n?P([i,e],o):[i,e,o]}}))},e.prototype.isFeatureSelected=function(t){if(this._selectedFeatureIds){var e=this._getFeatureFilterId(t);if(e)return-1!==this._selectedFeatureIds.indexOf(e)}return!1},e.prototype._onLayerMouseMove=function(){this.map&&(this.map.getCanvas().style.cursor="pointer")},e.prototype._onLayerMouseLeave=function(){this.map&&(this.map.getCanvas().style.cursor="")},e.prototype._detectPaintType=function(t){if("type"in t)return t.type;if("function"==typeof t)try{var e=t({type:"Feature",properties:{},geometry:{}});return this._detectPaintType(e)}catch(t){}},e.prototype._addEventsListeners=function(){var t=this;this.layer&&this.options&&this.options.selectable&&this.layer.forEach((function(e){t.$onLayerMouseMove&&t.map&&t.map.on("mousemove",e,t.$onLayerMouseMove),t.$onLayerMouseLeave&&t.map&&t.map.on("mouseleave",e,t.$onLayerMouseLeave)}))},e.prototype._removeEventListeners=function(){this.$onLayerMouseMove&&this.map&&this.map.off("mousemove",this.$onLayerMouseMove),this.$onLayerMouseLeave&&this.map&&this.map.off("mouseleave",this.$onLayerMouseLeave)},e}(c),x=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),F=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},j=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return x(e,t),e.prototype.addLayer=function(e){return F(this,void 0,void 0,(function(){var r;return j(this,(function(n){switch(n.label){case 0:return[4,t.prototype.addLayer.call(this,e)];case 1:return r=n.sent(),this._updateLayerPaint(this.options.type||"polygon"),[2,r]}}))}))},e.prototype._getAdditionalLayerOptions=function(){return!e.sources.includes(this.options.url)&&this.map&&(this.map.addSource(this.options.url,{type:"vector",tiles:[this.options.url]}),this.source=this.options.url,e.sources.push(this.options.url)),{source:this.options.url,"source-layer":this.options.sourceLayer}},e.sources=[],e}(k),T=r(30),M=r.n(T),N=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),R=function(){return(R=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return N(e,t),e.prototype.addLayer=function(t){var e,r=(t=R(R({},this.options),t||{})).minZoom,n=t.maxZoom;(e=t&&t.subdomains?t.subdomains.split("").map((function(e){return t.url.replace("{s}",e)})):[t.url],t.headers)&&this.map.transformRequests.push((function(e,r){var n=e;if((n=(n=(n=n.replace(/(z=\d+)/,"z={z}")).replace(/(x=\d+)/,"x={x}")).replace(/(y=\d+)/,"y={y}"))===t.url)return{url:e,headers:t.headers}}));var o={type:"raster",tiles:e,tileSize:256};t.attribution&&(o.attribution=t.attribution);var i={id:this._layerId,type:"raster",layout:{visibility:"none"},source:o};if(r&&(i.minzoom=r-1),n&&(i.maxzoom=n-1),this.map)return this.map.addLayer(i,t.before),this.layer=[this._layerId]},e}(c),z=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),D={url:"http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org/copyright" target="_blank">OpenStreetMap</a> contributors',subdomains:"abc"},Z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return z(e,t),e.prototype.addLayer=function(e){return t.prototype.addLayer.call(this,Object.assign({},D,e))},e}(B),q=r(23),G=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),Q=function(){return(Q=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},H=function(t){function e(e){void 0===e&&(e={});return e=Q(Q({},e),{showCompass:!1}),t.call(this,e)||this}return G(e,t),e.prototype._createButton=function(e,r,n){var o=t.prototype._createButton.call(this,e,r,n),i={"Zoom in":"zoomInTitle","Zoom out":"zoomOutTitle"}[r],a=i&&this.options[i];return a&&(o.title=a,o.setAttribute("aria-label",a)),o},e}(T.NavigationControl),$=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),V=function(t){function e(e){void 0===e&&(e={});return e=Object.assign({},e,{showZoom:!1}),t.call(this,e)||this}return $(e,t),e}(T.NavigationControl),U=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),J=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return U(e,t),e}(T.AttributionControl),K=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),W=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},X=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},Y=function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;var n=Array(t),o=0;for(e=0;e<r;e++)for(var i=arguments[e],a=0,s=i.length;a<s;a++,o++)n[o]=i[a];return n},tt=0,et=function(t){function e(e,r){var n=t.call(this,e,r)||this;return n.map=e,n.options=r,n.selected=!1,n._features=[],n._sources={},n.source=n._sourceId,n}return K(e,t),e.prototype.addLayer=function(e){return W(this,void 0,void 0,(function(){var r;return X(this,(function(n){switch(n.label){case 0:return[4,t.prototype.addLayer.call(this,e)];case 1:return r=n.sent(),this.options.data&&this.addData(this.options.data),[2,r]}}))}))},e.prototype.beforeRemove=function(){this.map&&(this.map.getSource(this._sourceId)&&this.map.removeSource(this._sourceId));t.prototype.beforeRemove.call(this)},e.prototype.clearLayer=function(t){var e=[],r=this.map.getSource(this._sourceId);t&&(e=this._features=this._features.filter((function(e){return!t(e)}))),this._features=e,r.setData({type:"FeatureCollection",features:e})},e.prototype.addData=function(t){return W(this,void 0,void 0,(function(){var e,r,n=this;return X(this,(function(o){switch(o.label){case 0:return this.options.type&&(e=this.options.type),!e&&t&&(r=function(t){var e;if("FeatureCollection"===t.type)e=m(t.features.map((function(t){return t.geometry.type})));else if("GeometryCollection"===t.type){e=m(t.geometries.map((function(t){return t.type})))}else e="Feature"===t.type?t.geometry.type:t.type;return e}(t),e=l[r]),t&&e?(this.filterGeometries(t,e).forEach((function(t){var e="_"+tt++;t._featureFilterId=e,t.properties&&(t.properties[n.featureIdName]=e)})),this._filterFun&&this._filter(this._filterFun),[4,this._updateLayerPaint(e)]):[3,2];case 1:o.sent(),this.map.getSource(this._sourceId).setData({type:"FeatureCollection",features:this._features}),o.label=2;case 2:return[2]}}))}))},e.prototype.getLayers=function(){var t=this,e=this._filteredFeatureIds,r=this._filterProperties;return r&&this._updateWithNativeFilter(r),this._getFeatures().map((function(n){var o=!1;if(r&&n.properties)o=Object(a.b)(n,r);else if(e){var i=t._getFeatureFilterId(n);void 0!==i&&(o=-1!==e.indexOf(i))}return{feature:n,visible:o}}))},e.prototype.filter=function(t){this._filterFun=t,this._filter(t)},e.prototype.removeFilter=function(){this._filterFun=void 0,this._filteredFeatureIds=void 0,this._updateFilter()},e.prototype.getSelected=function(){var t=this,e=[],r=this._selectedFeatureIds,n=this._selectProperties,o=this._getFeatures();return r&&r.length?o.forEach((function(n){var o=t._getFeatureFilterId(n);o&&-1!==r.indexOf(o)&&e.push({feature:n})})):this.source&&n&&o.filter((function(t){return Object(a.b)(t,n)})).forEach((function(t){e.push({feature:t})})),e},e.prototype.select=function(e){if(e)if("function"==typeof e){var r=this._getFeatures().filter((function(t){return e({feature:t})}));this._selectFeature(r)}else this.selected=!0,this._selectProperties=e,t.prototype._updateFilter.call(this),this._fireOnLayerSelectEvent();else this.selected||this._selectFeature(this._getFeatures())},e.prototype.unselect=function(t){if(this._selectProperties=void 0,t){if("function"==typeof t){var e=this._getFeatures().filter((function(e){return t({feature:e})}));this._unselectFeature(e),this.selected=!!Array.isArray(this._selectedFeatureIds)}}else this.selected&&(this.selected=!1,this._unselectFeature())},e.prototype._onAddLayer=function(t){var e=this,r=this.map.getSource(t);if(!r){var n={type:"geojson",data:{type:"FeatureCollection",features:[]}};["cluster","clusterMaxZoom","clusterRadius"].forEach((function(t){var r=e.options[t];void 0!==r&&(n[t]=r)})),this.map.addSource(t,n),r=this.map.getSource(t)}this._sources[t]=r,this.options.type&&this._updateLayerPaint(this.options.type)},e.prototype._createPaintForType=function(e,r,n){return W(this,void 0,void 0,(function(){return X(this,(function(o){switch(o.label){case 0:return"function"!=typeof e?[3,2]:[4,this._getPaintFromCallback(e,r,n)];case 1:return[2,o.sent()];case 2:return[2,t.prototype._createPaintForType.call(this,e,r,n)]}}))}))},e.prototype._selectFeature=function(t,e){var r=this;void 0===e&&(e={silent:!1});var n=this._selectedFeatureIds||[];this.options&&!this.options.multiselect&&(n=[]);var o=[];return(o=Array.isArray(t)?t:[t]).forEach((function(t){var e=r._getFeatureFilterId(t);void 0!==e&&n.push(e)})),this._selectProperties=void 0,this._selectedFeatureIds=n,this._updateFilter(),!e.silent&&this.options.onLayerSelect&&this.options.onLayerSelect({layer:this,features:o}),o},e.prototype._unselectFeature=function(t,e){var r=this;if(void 0===e&&(e={silent:!1}),t){var n=[];(n=Array.isArray(t)?t:[t]).length&&n.forEach((function(t){var e=r._getFeatureFilterId(t),n=r._selectedFeatureIds;if(n&&void 0!==e){var o=n.indexOf(e);-1!==o&&n.splice(o,1)}}))}else this._selectedFeatureIds=!1;this._updateFilter(),!e.silent&&this.options.onLayerSelect&&this.options.onLayerSelect({layer:this,features:void 0})},e.prototype._updateFilter=function(){var e=this;if(this._filterProperties||this._selectProperties)return t.prototype._updateFilter.call(this),void this._fireOnLayerSelectEvent();var r=this._selectedFeatureIds,n=[],o=[],i=this._filteredFeatureIds;i?this._getFeatures().forEach((function(t){var a=e._getFeatureFilterId(t);void 0!==a&&-1!==i.indexOf(a)&&(r&&-1!==r.indexOf(a)?n.push(a):o.push(a))})):r&&(n=r),this.selected=!!r;var a=this.layer;a&&this._types.forEach((function(t){var r=f[t];if(r){var s=["==","$type",r],u=e._getLayerNameFromType(t),c=e._getSelectionLayerNameFromType(t);if(-1!==a.indexOf(c)&&e._selectionName&&e.map.setFilter(c,["all",s,Y(["in",e.featureIdName],n)]),-1!==a.indexOf(u)){var p=["all",s];i?p.push(Y(["in",e.featureIdName],o)):(p.push(Y(["!in",e.featureIdName],n)),e._updateWithNativeFilter(p)),e.map.setFilter(u,p)}}}))},e.prototype._getFeatures=function(){if(this.source){var t=this.map.getSource(this.source);if(t)return t._data?t._data.features:[]}return this._features},e.prototype._filter=function(t){var e=this,r=[];this._getFeatures().forEach((function(n){var o=t({feature:n}),i=e._getFeatureFilterId(n);o&&i&&r.push(i)})),this._filteredFeatureIds=r,this._updateFilter()},e.prototype.filterGeometries=function(t,e){var r=[];if("FeatureCollection"===t.type){var n=t.features.filter((function(t){return _(t.geometry.type,e)}));t.features=n,r=n}else if("Feature"===t.type){if(!_(t.geometry.type,e))return[];r.push(t)}else if("GeometryCollection"===t.type){var o=t;o.geometries=o.geometries.filter((function(t){return _(t.type,e)})),r=o.geometries.map((function(t){return{type:"Feature",geometry:t,properties:{}}}))}else if(l[t.type]){r=[{type:"Feature",geometry:t,properties:{}}]}return this._features=this._features.concat(r),r},e.prototype._getPaintFromCallback=function(t,e,r){return W(this,void 0,void 0,(function(){var n,o,i,a,s,u,c;return X(this,(function(p){switch(p.label){case 0:(n={}).type=t.type,o=0,i=this._features,p.label=1;case 1:return o<i.length?(a=i[o],"icon"!==(s=t(a)).type?[3,3]:[4,this._registerImage(s)]):[3,5];case 2:return p.sent(),a.properties&&(a.properties["_icon-image-"+r]=s.html),n["icon-image"]="{_icon-image-"+r+"}",[3,4];case 3:for(u in s)c=s[u],a.properties&&(a.properties["_paint_"+u+"_"+r]=c),n[u]=["get","_paint_"+u+"_"+r];p.label=4;case 4:return o++,[3,1];case 5:return"icon-image"in n?[2,n]:[2,this._createPaintForType(n,e,r)]}}))}))},e.prototype._fireOnLayerSelectEvent=function(){if(this.options.onLayerSelect){var t=[];this.getSelected().forEach((function(e){e.feature&&t.push(e.feature)}));var e=t.length?t:void 0;this.options.onLayerSelect({layer:this,features:e})}},e}(k);function rt(t,e){return void 0===e&&(e={}),new(function(){function r(){}return r.prototype.getDefaultPosition=function(){return"top-left"},r.prototype.onAdd=function(){var r=document.createElement("div"),n=t.onAdd();return r.classList.add("mapboxgl-ctrl"),e.bar&&r.classList.add("mapboxgl-bar"),e.addClass&&r.classList.add(e.addClass),n&&r.appendChild(n),this._container=r,this._container},r.prototype.onRemove=function(){if(this._container){var e=this._container.parentNode;e&&e.removeChild(this._container)}return t.onRemove()},r.prototype.remove=function(){this.onRemove()},r}())}var nt=function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),ot=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return nt(e,t),e.prototype.addLayer=function(e){var r={bbox:"{bbox-epsg-3857}",format:e.format||"image/png",service:"WMS",version:"1.1.1",request:"GetMap",srs:"EPSG:3857",transparent:"true",width:e.tileSize||"256",height:e.tileSize||"256",layers:e.layers||""},n=Object.keys(r).map((function(t){return t+"="+r[t]})).join("&");return e.url=e.url+"?"+n,t.prototype.addLayer.call(this,e)},e}(B),it=function(){return(it=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},at=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},st=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},ut={},ct=function(){function t(){var e=this;this.options={},this.emitter=new q.EventEmitter,this.layerAdapters=t.layerAdapters,this.controlAdapters=t.controlAdapters,this.isLoaded=!1,this._universalEvents=["zoomstart","zoom","zoomend","movestart","move","moveend"],this._sourceDataLoading={},this.__setLayerOrder=Object(o.debounce)((function(t){return e._setLayerOrder(t)}))}return t.prototype.create=function(t){var e=this;return new Promise((function(r,n){if(!e.map&&(e.options=t,t.accessToken&&(M.a.accessToken=t.accessToken),t.target)){var o={container:t.target,attributionControl:!1,bounds:t.bounds,fitBoundsOptions:it(it({},t.fitOptions),ut),transformRequest:function(t,r){var n=e._transformRequest(t,r);return n||{url:t}}};"string"==typeof t.style?o.style=t.style:o.style=it({version:8,name:"Empty style",sources:{},layers:[]},t.style),void 0!==t.center&&(o.center=t.center),void 0!==t.zoom&&(o.zoom=t.zoom-1),t.maxZoom&&(o.maxZoom=t.maxZoom-1),t.minZoom&&(o.minZoom=t.minZoom-1),e.map=new T.Map(o),e.map.once("load",(function(){e.map._onMapClickLayers=[],e.map.transformRequests=[],e.isLoaded=!0,e.emitter.emit("create",e),r(e)})),e._addEventsListeners()}}))},t.prototype.destroy=function(){this.map&&this.map.remove()},t.prototype.getContainer=function(){return this.map&&this.map.getContainer()},t.prototype.setView=function(t,e){if(this.map){var r={center:t};e&&(r.zoom=e-1),this.map.jumpTo(r)}},t.prototype.setCenter=function(t){this.map&&this.map.setCenter(t)},t.prototype.getCenter=function(){if(this.map){var t=this.map.getCenter();return[t.lng,t.lat]}},t.prototype.setZoom=function(t){this.map&&this.map.setZoom(t-1)},t.prototype.getZoom=function(){if(this.map){var t=this.map.getZoom();if(t<1)return;return t?t+1:void 0}},t.prototype.getBounds=function(){if(this.map){var t=this.map.getBounds().toArray();return[t[0][0],t[0][1],t[1][0],t[1][1]]}},t.prototype.fitBounds=function(t,e){return void 0===e&&(e={}),at(this,void 0,void 0,(function(){var r;return st(this,(function(n){return this.map&&(r=it(it({linear:!0,duration:0},e),ut),this.map.fitBounds([[t[0],t[1]],[t[2],t[3]]],r),Object(o.sleep)(r.duration)),[2]}))}))},t.prototype.setRotation=function(t){},t.prototype.showLayer=function(t){var e=this;t&&t.forEach((function(t){e._toggleLayer(t,!0)}))},t.prototype.hideLayer=function(t){var e=this;t&&t.forEach((function(t){e._toggleLayer(t,!1)}))},t.prototype.removeLayer=function(t){var e=this.map;e&&t&&Array.isArray(t)&&t.forEach((function(t){e.removeLayer(t),e.getSource(t)&&e.removeSource(t)}))},t.prototype.setLayerOrder=function(t,e,r){this.__setLayerOrder(r)},t.prototype.setLayerOpacity=function(t,e){var r=this,n=this.map;n&&t.forEach((function(t){r._onMapLoad().then((function(){var r=n.getLayer(t);r&&("symbol"===r.type?(n.setPaintProperty(t,"text-opacity",e),n.setPaintProperty(t,"icon-opacity",e)):n.setPaintProperty(t,r.type+"-opacity",e))}))}))},t.prototype.createControl=function(t,e){return rt(t,e)},t.prototype.createButtonControl=function(t){return function(t){var e=document.createElement("button");if(e.className="mapboxgl-ctrl-icon",e.setAttribute("role","button"),t.title&&(e.title=t.title,e.setAttribute("aria-label",t.title)),t.html){t.html instanceof HTMLElement?e.appendChild(t.html):e.innerHTML=t.html;var r=e.firstElementChild;r&&(r.style.width="100%",r.style.height="100%",r.style.lineHeight=(e.offsetHeight||30)+"px")}t.addClass&&t.addClass.split(" ").forEach((function(t){return e.classList.add(t)}));var n=function(e){e.stopPropagation(),t.onClick()};return void 0!==t.onClick&&e.addEventListener("click",n),rt({onAdd:function(){return e},onRemove:function(){var r=e.parentNode;r&&r.removeChild(e),void 0!==t.onClick&&e.removeEventListener("click",n)}},{bar:!0,addClass:"mapboxgl-ctrl-group"})}(t)},t.prototype.addControl=function(t,e){if(this.map)return this.map.addControl(t,e),t},t.prototype.removeControl=function(t){this.map&&this.map.removeControl(t)},t.prototype.onMapClick=function(t){var e=t.lngLat,r=t.point,n=r.x,o=r.y;this.emitter.emit("preclick",{latLng:e,pixel:{top:o,left:n}}),this.map&&this.map._onMapClickLayers.sort((function(t,e){return t.options&&t.options.order&&e.options&&e.options.order?e.options.order-t.options.order:1})).find((function(e){return e._onLayerClick(t)})),this.emitter.emit("click",{latLng:e,pixel:{top:o,left:n}})},t.prototype._onMapLoad=function(t){var e=this;return new Promise((function(r){var n=function(){t&&t(),e.map&&r(e.map)};e.isLoaded?n():e.map&&e.emitter.once("create",(function(){n()}))}))},t.prototype._setLayerOrder=function(t){var e=this.map;if(e){var r=[],n=[];for(var o in t){var i=t[o];i.options.baselayer?r.push(i):n.push(i)}r.forEach((function(t){t.layer&&t.layer.forEach((function(t){e.moveLayer(t)}))})),n=n.sort((function(t,e){return void 0!==t.options.order&&void 0!==e.options.order?t.options.order-e.options.order:0}));for(var a=0;a<n.length;a++){var s=n[a];this._getLayerIds(s).forEach((function(t){e.moveLayer(t)}))}}},t.prototype._getLayerIds=function(t){var e=[];if(t)if(Array.isArray(t.layer))e=t.layer;else if(t.getDependLayers){t.getDependLayers().forEach((function(t){var r=t.layer&&t.layer.layer||t;Array.isArray(r)&&r.forEach((function(t){e.push(t)}))}))}return e},t.prototype._toggleLayer=function(t,e){this._onMapLoad().then((function(r){r.setLayoutProperty(t,"visibility",e?"visible":"none")}))},t.prototype._onMapSourceData=function(t){var e=this;if("source"===t.dataType){var r=t.isSourceLoaded;this._onDataLoad(t,r,(function(t){e.emitter.emit("data-loaded",{target:t})}))}},t.prototype._onMapError=function(t){var e=this;if(this._sourceDataLoading[t.sourceId]){var r=t.isSourceLoaded;this._onDataLoad(t,r,(function(t){e.emitter.emit("data-error",{target:t})}))}},t.prototype._onDataLoad=function(t,e,r){if(void 0===e&&(e=!1),e)Object.keys(this._sourceDataLoading).forEach((function(t){r(t)})),this._sourceDataLoading={};else{var n=this._sourceDataLoading[t.sourceId];if(n&&t.tile){var o=n.indexOf(t.tile);-1!==o&&this._sourceDataLoading[t.sourceId].splice(o,1),n.length||(r(t.sourceId),delete this._sourceDataLoading[t.sourceId])}}},t.prototype._transformRequest=function(t,e){var r=this.map&&this.map.transformRequests;if(r)for(var n=0,o=r;n<o.length;n++){var i=(0,o[n])(t,e);if(i)return i}else;},t.prototype._addEventsListeners=function(){var t=this,e=this.map;e&&(e.on("sourcedataloading",(function(e){t._sourceDataLoading[e.sourceId]=t._sourceDataLoading[e.sourceId]||[],e.tile&&t._sourceDataLoading[e.sourceId].push(e.tile)})),e.on("sourcedata",this._onMapSourceData.bind(this)),e.on("error",this._onMapError.bind(this)),e.on("click",(function(e){t.onMapClick(e)})),this._universalEvents.forEach((function(r){e.on(r,(function(){return t.emitter.emit(r,t)}))})))},t.layerAdapters={TILE:B,WMS:ot,MVT:I,OSM:Z,GEOJSON:et},t.controlAdapters={ZOOM:H,COMPASS:V,ATTRIBUTION:J},t}();e.a=ct},300:function(t,e,r){"use strict";r.d(e,"a",(function(){return o}));var n,o,i=r(50),a=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),s=function(t){function e(r){var n=t.call(this)||this;return n.name="NetworkError",Object.setPrototypeOf(n,e.prototype),n.message="Unable to request "+r+".\n    Possibly invalid NGW URL entered or CORS not configured to get request from "+location.origin,n}return a(e,t),e}(Error);o=function(t,e,r,n,o){void 0===r&&(r={}),r.method=r.method||"GET";var a=new XMLHttpRequest;a.open(r.method||"GET",t,!0),"blob"===r.responseType&&(a.responseType=r.responseType);var u=function(){try{return JSON.parse(a.responseText)}catch(t){return a.responseText}};a.onload=function(){-1!==[403,404,500].indexOf(a.status)&&n(new i.a(u())),function(t){void 0===t&&(t=!1);var o=t?n:e;"blob"===r.responseType?o(a.response):a.responseText?o(u()):n({message:""})}()},a.onerror=function(e){0===a.status?n(new s(t)):n(e)},a.upload.onprogress=function(t){if(t.lengthComputable){var e=t.loaded/t.total*100;r.onProgress&&r.onProgress(e,t)}};var c,p=r.headers;if(p)for(var l in p){var f=p[l];"string"==typeof f&&a.setRequestHeader(l,f)}if(void 0!==r.withCredentials&&(a.withCredentials=r.withCredentials),r.file){if((c=new FormData).append("file",r.file),r.data)for(var h in c)c.append(h,c[h])}else c=r.data?"string"==typeof r.data?r.data:JSON.stringify(r.data):null;o&&o((function(){a.abort()})),a.send(c)}},37:function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return u})),r.d(e,"c",(function(){return c}));var n=r(11),o=function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function i(t,e,r){if((e=String(e))===(t=String(t)))return!0;if(r&&e.toUpperCase()===t.toUpperCase())return!0;var o=("^"+Object(n.reEscape)(e)+"$").replace(/%/g,".*").replace("_",".");return null!==new RegExp(o,r?"i":"").exec(t)}var a={gt:function(t,e){return t>e},lt:function(t,e){return t<e},ge:function(t,e){return t>=e},le:function(t,e){return t<=e},eq:function(t,e){return t===e},ne:function(t,e){return t!==e},in:function(t,e){return-1!==e.indexOf(t)},notin:function(t,e){return-1===e.indexOf(t)},like:function(t,e){return i(t,e)},ilike:function(t,e){return i(t,e,!0)}};function s(t){var e=t;return 3===e.length&&"string"==typeof e[0]&&"string"==typeof e[1]}function u(t,e){var r=o({},t.properties);return!!r&&(r.$id=t.id,c(r,e))}function c(t,e){var r="string"==typeof e[0]?e[0]:"all",n=function(e){if(s(e)){var r=e[0],n=e[1],o=e[2],i=a[n];if(i){if(("like"===n||"ilike"===n)&&"string"==typeof r){var u="",p=r.replace(/^%?(\w+)%?$/,(function(e,n){return u=t[n],r.replace(n,o)}));return i(u,p)}return i(t[r],o)}return!1}return c(t,e)},o=e.filter((function(t){return Array.isArray(t)}));return"any"===r?o.some(n):o.every(n)}},41:function(t,e,r){"use strict";var n,o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=function(t){function e(){var r=t.call(this)||this;return r.name="CancelError",Object.setPrototypeOf(r,e.prototype),r}return o(e,t),e}(Error),a=function(t,e,r,n){try{t(r(n))}catch(t){e(t)}},s=0,u=function(){function t(e){var r=this;this.id=s++,this._isCanceled=!1,this._isPending=!0,this._cancelHandlers=[],this._children=[],this._cancelPromise=new Promise((function(t,e){r._setCanceledCallback=function(e){return t(e||new i)}})),this._promise=Promise.race([this._cancelPromise,new Promise((function(n,o){return e((function(e){e instanceof t?r.attach(e):r._isPending=!1,n(e)}),(function(t){r._isPending=!1,o(t)}),(function(t){if(!r._isPending)throw new Error("The `onCancel` handler was attached after the promise settled.");r._cancelHandlers.push(t)}))}))])}return t.resolve=function(e){return new t((function(t){return t(e)}))},t.reject=function(e){return new t((function(t,r){return r(e)}))},t.all=function(e){return new t((function(t,r){Promise.all(e).then(t).catch(r)}))},t.prototype.attach=function(t){this._isCanceled?t.cancel():this._children.push(t)},t.prototype.then=function(e,r){var n=this,o=new t((function(t,o){if(n._promise){var i=function(e){r?a(t,o,r,e):o(e)};n._promise.then((function(r){n._isCanceled?i(r):e?a(t,o,e,r):t(r)}),i)}}));return o._parentPromise=this,this._children.push(o),o},t.prototype.catch=function(t){return this._isCanceled&&t&&t(new i),this.then(void 0,t)},t.prototype.finally=function(t){return this._promise?this._promise.finally(t):this._isCanceled?Promise.reject(new i):Promise.reject(t)},t.prototype.cancel=function(){if(this._isCanceled)return this;this._isCanceled=!0;var t=this._getTopParent();if(t&&t.cancel(),this._children&&this._children.forEach((function(t){return t.cancel()})),this._isPending){if(this._cancelHandlers.length)try{for(var e=0,r=this._cancelHandlers;e<r.length;e++){(0,r[e])()}}catch(t){}this._setCanceledCallback&&this._setCanceledCallback()}return this._destroy(),this},t.prototype._getTopParent=function(){for(var t=this._parentPromise,e=!!t;e;)e=!(!t||!t._parentPromise)&&!!(t=t._parentPromise);return t},t.prototype._destroy=function(){this._setCanceledCallback=void 0,this._cancelPromise=void 0,this._promise=void 0},t.CancelError=i,t}();Object.setPrototypeOf(u.prototype,Promise.prototype);e.a=u},49:function(t,e,r){"use strict";function n(t){return!!Array.isArray(t)}function o(t){return!!Array.isArray(t)}function i(t){return"[object Object]"===Object.prototype.toString.call(t)}function a(t){return"function"==typeof t}function s(t){return"icon"===t.type||"html"in t}r.d(e,"a",(function(){return n})),r.d(e,"e",(function(){return o})),r.d(e,"c",(function(){return i})),r.d(e,"d",(function(){return a})),r.d(e,"b",(function(){return s}))},50:function(t,e,r){"use strict";r.d(e,"a",(function(){return i}));var n,o=(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=function(t){function e(r){var n=t.call(this)||this;return n.name="NgwError",Object.assign(n,r),Object.setPrototypeOf(n,e.prototype),n}return o(e,t),e}(Error)},509:function(t,e,r){},522:function(t,e,r){t.exports=r(301)},56:function(t,e,r){"use strict";var n=r(245);r.o(n,"isIcon")&&r.d(e,"isIcon",(function(){return n.isIcon})),r.o(n,"isPaint")&&r.d(e,"isPaint",(function(){return n.isPaint})),r.o(n,"preparePaint")&&r.d(e,"preparePaint",(function(){return n.preparePaint}));var o=r(49);r.d(e,"isIcon",(function(){return o.b})),r.d(e,"isPaint",(function(){return o.c}));r(112);var i=r(246);r.d(e,"preparePaint",(function(){return i.a}))},57:function(t){t.exports=JSON.parse('{"baseUrl":"https://gis.runivers.ru","#sourceGroups":[{"name":"status2","resourceId":13819,"order":40}],"sourceGroups":[{"name":"base","resourceId":5344,"opacity":0.5,"order":10},{"name":"status1","resourceId":13818,"order":20},{"name":"lines","resourceId":14878,"order":30},{"name":"cities","resourceId":11486,"order":40}],"pointsGroupId":6541,"lineColorLegend":{"base":[[1,"#33b850","Основная территория государства",[1,6]],[2,"#527800","Самостоятельные территории (княжества и т.п.)",[8]],[3,"#79d254","Территория под протекторатом, в вассальной зависимости или в сфере влияния",[2]],[4,"#01d0a4","Аренда, совместное владение, спорная территория",[3,4,5]],[5,"#a3ada3","Утраченная территория",[7]]],"lines":[[6,{"width":2.06,"color":"rgba(132, 73, 58, 1.00)","type":"line"},"Определенно локализуемая граница",[1]],[7,{"width":2.06,"color":"rgba(132, 73, 58, 0.30)","type":"line"},"Граница, локализованная приблизительно",[2]],[8,{"width":3.26,"color":"rgba(255,255,255, 0.25)","type":"line"},"Условная граница",[3]]]}}')},87:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"b",(function(){return o}));var n={tms:"TILE"};function o(t){var e=("https:"===location.protocol?"https":"http")+"://",r=t.url.replace(/^(https?|ftp):\/\//,e);return t.y_origin_top||(r=r.replace("{y}","{-y}")),{url:r,name:t.name,attribution:t.copyright_text,maxZoom:t.z_max,minZoom:t.z_min}}},88:function(t,e,r){"use strict";r.d(e,"a",(function(){return c}));var n=r(11),o=r(87);function i(t){return new Promise((function(e,r){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState&&200===o.status&&o.responseText)try{e(JSON.parse(o.responseText))}catch(t){r(t)}},o.open("GET",Object(n.fixUrlStr)(t),!0),o.send()}))}var a=function(){return(a=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},s=function(t,e,r,n){return new(r||(r=Promise))((function(o,i){function a(t){try{u(n.next(t))}catch(t){i(t)}}function s(t){try{u(n.throw(t))}catch(t){i(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(a,s)}u((n=n.apply(t,e||[])).next())}))},u=function(t,e){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function c(t,e){return void 0===e&&(e="https://qms.nextgis.com"),function(){function r(t,e){this.map=t,this.options=e,this.options.baselayer=!0}return r.prototype.addLayer=function(c){return s(this,void 0,void 0,(function(){var s,p,l,f,h;return u(this,(function(u){switch(u.label){case 0:if(this.qms||!c.qmsId)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),s=this,[4,i(e+"/api/v1/geoservices/"+c.qmsId)];case 2:return s.qms=u.sent(),[3,4];case 3:return p=u.sent(),console.error(p),[3,4];case 4:return(l=this.qms)&&(f=o.a[l.type||"tms"],(h=t.mapAdapter.layerAdapters[f])&&(Object(n.mixinProperties)(r,h,["showLayer","hideLayer"]),"TILE"===f))?(c=a(a({order:0,maxZoom:t.options.maxZoom,minZoom:t.options.minZoom},this.options),Object(o.b)(l)),this.options=c,[2,new h(this.map,c).addLayer(c)]):[2]}}))}))},r}()}},91:function(t,e,r){"use strict";var n=r(285),o=(r(508),r(509),function(){return(o=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)}),i=function(){function t(e){this.options={template:"\n      <p>This is dialog!</p>\n    ",closeBtn:!0,closeBtnTemplate:'\n  <a href="#">\n    <svg height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">\n      <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z">\n      </path>\n      <path d="M0 0h24v24H0z" fill="none"></path>\n    </svg>\n  </a>\n'},this._dialog=document.createElement("dialog"),t.dialogs.push(this),this._dialog.className="dialog-component",this.options=o(o({},this.options),e),this._parent=this.options.parent||document.body,this._isNativeDialog=!!this._dialog.showModal,this._isNativeDialog||(n.a.registerDialog(this._dialog),this._dialog.classList.add("polyfilled")),this.options.closeBtn&&(this._closeBtn=this._createCloseBtn()),this._content=document.createElement("div"),this._dialog.appendChild(this._content),this.updateContent(),this._parent&&this._parent.appendChild(this._dialog),this._addEventsListeners()}return t.clean=function(){t.dialogs.forEach((function(t){return t.destroy()}))},t.prototype.getContainer=function(){return this._dialog},t.prototype.show=function(){this._dialog.showModal()},t.prototype.close=function(){this._dialog.close()},t.prototype.destroy=function(){this.close(),this._dialog.remove()},t.prototype.updateContent=function(t){!t&&this.options.template&&(t=this.options.template),t&&this._addContent(t,this._content)},t.prototype._createCloseBtn=function(){var t=this,e=this.options.closeBtnTemplate;if(e){var r=document.createElement("div");return r.className="dialog-component__close",this._dialog.appendChild(r),this._addContent(e,r),r.addEventListener("click",(function(e){e.stopPropagation(),t.close()})),r}},t.prototype._addContent=function(t,e){"string"==typeof t?e.innerHTML=t:t instanceof HTMLElement&&(e.innerHTML="",e.appendChild(t))},t.prototype._addEventsListeners=function(){var t=this;this._closeBtn&&this._closeBtn.addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),t.close()})),this.options.openers&&[].forEach.call(this.options.openers,(function(e){e.onclick=function(e){e.preventDefault(),t.show()}})),this._dialog.addEventListener("close",(function(){})),this._dialog.addEventListener("cancel",(function(){}))},t.dialogs=[],t}();e.a=i}}]);