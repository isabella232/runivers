(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{265:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i,o=n(41),r=(n(486),n(107)),a=n.n(r),s=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),p=function(){return(p=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},c={addClass:"legend-panel"},l=function(t){function e(e){var n=t.call(this,p(p({},c),e))||this;return n.options=e,n._createLegendBody(),n._addEventsListener(),n}return s(e,t),e.prototype.createLegendBlock=function(t){var e=this;void 0===t&&(t=!1);var n=document.createElement("div");n.className="panel-body__legend";var i=this.options.colors;return i&&i.forEach((function(i){n.appendChild(e._createLegendItem(i,t))})),n},e.prototype._createLegendBody=function(){var t=this.createLegendBlock(),e=document.createElement("div");return e.className="panel-body__legend--button",e.innerHTML='<a\n      href="https://www.runivers.ru/granitsy-rossii/charts/index.php"\n      target=\'_blank\'\n      class="btn panel-button">ГРАФИК ИЗМЕНЕНИЯ ТЕРРИТОРИИ\n    </a>',t.appendChild(e),this.updateBody(t),t},e.prototype._createLegendItem=function(t,e){var n=this;void 0===e&&(e=!1);var i=document.createElement("div");i.className="panel-body__legend--block";var o=t[0],r=t[1],s=t[2];if(e){var p=document.createElement("input");p.setAttribute("type","color"),p.className="editable-legend__color-input",p.value=r,i.appendChild(p);var c=function(t){return" - "+s+" ("+t+")"},l=document.createElement("span");l.className="panel-body__legend--name",l.innerHTML=c(r);var u=this.options.colors;p.onchange=function(){if(u){var t=u.find((function(t){return t[0]===o}));t&&(t[1]=p.value,l.innerHTML=c(p.value),n.emitter.emit("change",n.options.colors))}},i.appendChild(l)}else{var h=new a.a(r),d=document.createElement("div");d.className="panel-body__legend--color",d.style.backgroundColor=String(h.fade(.3)),d.style.border="2px solid "+h.darken(.5),i.appendChild(d);var f=document.createElement("div");f.className="panel-body__legend--name",f.innerHTML=""+s,i.appendChild(f)}return i},e.prototype._addEventsListener=function(){var t=this;this.emitter.on("change",(function(){t._createLegendBody()}))},e}(o.a)},266:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i,o=n(41),r=(n(492),n(47)),a=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s={headerText:"Правители",addClass:"period-panel"},p=function(t){function e(e){return t.call(this,Object.assign({},s,e))||this}return a(e,t),e.prototype.hide=function(){if(t.prototype.hide.call(this),this.webMap){var e=this.webMap.getContainer();e&&e.classList.remove("period-panel")}},e.prototype.show=function(){if(t.prototype.show.call(this),!this.isHide&&this.webMap){var e=this.webMap.getContainer();e&&e.classList.add("period-panel")}},e.prototype.updatePeriod=function(t,e){if(this.closeDialog(),t){var n=this.period,i=this.areaStat&&this.areaStat.area,o=e&&e.area;n===t&&i===o||(this.updateBody(this._createPeriodBody(t,e)),this.period=t,this.areaStat=e)}else this.updateBody('<div class="panel-body__period empty">В этом году изменений территории не было</div>'),this.period=void 0},e.prototype._createPeriodBody=function(t,e){var n=document.createElement("div");n.className="panel-body__period";var i=document.createElement("div"),o="";t.img_link&&(o='<div\n        class="panel-body__period--image" style="background-image: url(\''+t.img_link+"');\">\n      </div>"),i.innerHTML="\n      "+(o||"")+'\n      <div class="panel-body__period--name">'+t.name+'</div>\n      <div class="panel-body__period--period">'+t.years_from+" – "+t.years_to+' гг.</div>\n      <div class="panel-body__period--description">'+t.description+"</div>\n      "+(e?'\n      <div class="panel-body__period--description panel-body__period--area_wrap">\n        Общая площадь: <span class="panel-body__period--area">\n          '+Object(r.b)(e.area)+"\n        </span>\n      </div>\n      ":"")+"\n    ",n.appendChild(i);var a=t.detail_link&&this.createRefButton(t.detail_link);return a&&n.appendChild(a),n},e}(o.a)},267:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i,o=n(41),r=(n(493),n(47)),a=(i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)},function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),s=function(){return(s=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)},p={headerText:"Изменения в территориальном составе",addClass:"stat-panel"},c=function(t){function e(e){return t.call(this,s(s({},p),e))||this}return a(e,t),e.prototype.hide=function(){if(t.prototype.hide.call(this),this.webMap){var e=this.webMap.getContainer();e&&e.classList.remove("years-panel")}},e.prototype.show=function(){if(t.prototype.show.call(this),!this.isHide&&this.webMap){var e=this.webMap.getContainer();e&&e.classList.add("years-panel")}},e.prototype.updateYearStats=function(t,e){this.yearStats=t,this.areaStat=e,this.updateYearStat(this.yearStats[0])},e.prototype.updateYearStat=function(t){var e=this.yearStat,n=this.getContainer();n&&(n.classList.remove("gain"),n.classList.remove("lost")),t?e!==t&&(this.yearStat=t,this.updateBody(this._createPeriodBody(t))):(this.updateBody('<div class="panel-body__period empty">В этом году изменений территории не было</div>'),this.yearStat=void 0),this.emitter.emit("update",{yearStat:this.yearStat})},e.prototype._createPeriodBody=function(t){var e=this,n=document.createElement("div");n.className="panel-body__yearstat";var i=document.createElement("div");if(i.className="panel-body__period--year",i.innerHTML=t.year+" г.",n.appendChild(i),this.areaStat){var o=this.areaStat.plus;o&&n.appendChild(this._createGainBlock(o));var r=this.areaStat.minus,a=this.getContainer();r&&n.appendChild(this._createGainBlock(r,!0)),a&&a.classList.add(r?"lost":"gain")}this.yearStats&&this.yearStats.length>1&&n.appendChild(this._createStateSwitcher());var s=this._createDescriptionBlock(t);s&&n.appendChild(s);var p=t.description_long;if(p){var c=document.createElement("div");c.className="panel-body__period--description",c.innerHTML=""+p;var l=document.createElement("div");l.className="button-wrap",l.appendChild(this.createControlButton((function(){return e.openDialog({template:c})}))),n.appendChild(l)}return n},e.prototype._createStateSwitcher=function(){var t=this,e=document.createElement("div");e.className="panel-body__period--slider";var n=this.yearStats,i=this.yearStat;if(i&&n){var o=n.indexOf(i),r=0===o,a=n.length,s=o===a-1,p=function(e,i){var r=document.createElement("a");return r.setAttribute("href","#"),r.className=(e?"panel_slider prev":"panel_slider next")+(i?"":" hidden"),i&&(r.onclick=function(i){i.preventDefault();var r=n[e?o-1:o+1];t.updateYearStat(r)}),r};e.appendChild(p(!0,!r));var c=document.createElement("div");c.className="panel_slider-counter",c.innerHTML=i.numb+" из "+i.count,e.appendChild(c),e.appendChild(p(!1,!s))}return e},e.prototype._createDescriptionBlock=function(t){var e=document.createElement("div");if(t.description_short)return e.innerHTML='<div class="panel-body__period--description">'+t.description_short+"</div>",e},e.prototype._createGainBlock=function(t,e){var n=document.createElement("div");return n.className="panel-body__yearstat--gain "+(e?"lost":"gained"),n.innerHTML=(e?"-":"+")+Object(r.b)(t),n},e}(o.a)},268:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(){function t(t){var e=this;this.timeMap=t,this.__onLoadingStart=function(){return e._onLoadingStart()},this.__onLoadingStop=function(){return e._onLoadingStop()}}return t.prototype.onAdd=function(){var t=document.createElement("div");return this._container=t,this.timeMap&&(this.timeMap.emitter.on("loading:start",this.__onLoadingStart),this.timeMap.emitter.on("loading:finish",this.__onLoadingStop)),t},t.prototype.onRemove=function(){if(this.timeMap&&(this.timeMap.emitter.off("loading:start",this.__onLoadingStart),this.timeMap.emitter.off("loading:finish",this.__onLoadingStop)),this._container){var t=this._container.parentNode;t&&t.removeChild(this._container)}},t.prototype._onLoadingStart=function(){this._container&&(this._container.innerHTML="Loading...")},t.prototype._onLoadingStop=function(){this._container&&(this._container.innerHTML="")},t}()},280:function(t,e,n){"use strict";var i=n(23),o=(n(478),n(260)),r=n.n(o),a=n(261),s=n.n(a);n(479),n.p,n.p;n.d(e,"a",(function(){return c}));var p={type:"range",min:0,max:100,step:1,animationStep:1,value:50,animationDelay:100,filterPips:function(t,e){return 1===e?1:t%100?t%10?-1:0:1}},c=function(){function t(t){this.options=t,this.emitter=new i.EventEmitter,this.options=Object.assign({},p,t),this.options.animationStep=this.options.animationStep||this.options.step}return t.prototype.onAdd=function(t){return this.map=t,this._container=this._createContainer(),this._container},t.prototype.onRemove=function(){},t.prototype._createContainer=function(){var t=document.createElement("div");return t.className="mapboxgl-ctrl slider-control",t.appendChild(this._createSliderContainer()),(void 0===this.options.playerControl||this.options.playerControl)&&t.appendChild(this._createNavigationContainer()),t},t.prototype._createValueInput=function(){var t=this,e=this._createLabeledInput({type:"number",value:this.options.value}),n=e.input;return n.onchange=function(){t._onChange(t._getAllowedValue(Number(n.value)))},this._input=n,e.label},t.prototype._createAnimationStepInput=function(){var t=this._createLabeledInput({type:"number",label:"animation step",value:this.options.animationStep}),e=t.input,n=this.options;return e.onchange=function(){var t=Number(e.value);t=t<=0?n.animationStep:t>n.max?n.max:t,e.value=String(t),n.animationStep=t},this._animationStepInput=e,t.label},t.prototype._createAnimationDelayInput=function(){var t=this,e=this._createLabeledInput({type:"number",label:"amimation delay",value:this.options.animationDelay}),n=e.input;return n.onchange=function(){var e=Number(n.value);e=e<=0?1:e,t.options.animationDelay=e},e.label},t.prototype._createSliderContainer=function(){var t=this,e=document.createElement("span");e.className="slider-control-range";var n=document.createElement("div");e.appendChild(n);var i=this.options,o=i.min,a=i.max,p=i.step,c=r.a.create(n,{range:{min:o,max:a},step:p,tooltips:[s()({decimals:0})],start:[this.options.value],pips:void 0!==this.options.pips?this.options.pips:{mode:"steps",density:3,filter:this.options.filterPips}});return c.on("change",(function(e,n){t._onSliderClick(parseInt(e[0],10))})),c.target.addEventListener("click",(function(){t.stopAnimation()}),!0),this._sliderContainer=e,this._slider=c,e},t.prototype._createPlayerContainer=function(){var t=this,e=document.createElement("div");e.className="slider-control-block slider-control-player";var n=document.createElement("button");return n.className="player-button",n.onclick=function(){t._toggleAnimation()},e.appendChild(n),this._playerControl=n,e},t.prototype._createPlayerButton=function(){var t=this,e=document.createElement("button");return e.className="player-button",e.onclick=function(){t._toggleAnimation()},this._playerControl=e,e},t.prototype._createNavigationContainer=function(){var t=this,e=document.createElement("div");e.className="slider-control-block slider-control-steps";var n=function(n){var i=document.createElement("button");return i.className="slider-control-steps-btn",i.innerHTML='\n        <img src="images/rewind_'+(n?"previous":"next")+'.svg" width="24" height="24"/>\n      ',e.appendChild(i),n&&e.appendChild(t._createPlayerButton()),i.onclick=function(){t._stepReady((function(e){"boolean"!=typeof e&&t._nextStep(e)}),n,t.options.step)},i};return n(!0),n(),e},t.prototype._createLabeledInput=function(t){t=t||{};var e=document.createElement("input");e.className="slider-control-input",t.type&&e.setAttribute("type",t.type),t.value&&(e.value=t.value);var n=document.createElement(t.label?"label":"div");return n.className="slider-control-block",t.label&&(n.innerHTML=t.label+":"),n.appendChild(e),{label:n,input:e}},t.prototype.startAnimathin=function(){this._toggleAnimation(!0)},t.prototype.stopAnimation=function(){this._toggleAnimation(!1)},t.prototype._onSliderClick=function(t){this._animationStatus&&this.stopAnimation(),this._onChange(t)},t.prototype._onChange=function(t){this._slider&&this._slider.set(t),this._input&&(this._input.value=String(t)),this.emitter.emit("change",t)},t.prototype._toggleAnimation=function(t){t=void 0!==t?t:!this._animationStatus,this._animationStatus=t,this._playerControl&&this._playerControl.classList[this._animationStatus?"add":"remove"]("paused"),t?this._startAnimation():this._stopAnimation()},t.prototype._startAnimation=function(){var t=this;if(this._animationStatus){var e=(new Date).getTime();this._stepReady((function(n){if("boolean"!=typeof n&&n<t.options.max&&n>t.options.min&&t._animationStatus){var i=(new Date).getTime()-e,o=t.options.animationDelay-i;o=o>=0?o:0,setTimeout((function(){t._animationStatus&&(t._nextStep(n),t._startAnimation())}),o)}else t.stopAnimation()}))}else this.stopAnimation()},t.prototype._nextStep=function(t){this._slider&&this._slider.set(t),this._onChange(t)},t.prototype._stepReady=function(t,e,n){var i=this._getNextValue(e,n),o=this.options.value<=this.options.max&&this.options.value>=this.options.min;i&&o?(this.options.value=i,this.options.stepReady?this.options.stepReady(i,t,e):t(i)):t(!1)},t.prototype._getAllowedValue=function(t){return t<=this.options.min?this.options.min:t>this.options.max?this.options.max:t},t.prototype._getNextValue=function(t,e){if(this._slider){var n=this._slider.get();if("string"==typeof n){var i=parseInt(n,10),o=e||this.options.animationStep,r=t?i-o:i+o;return this._getAllowedValue(r)}}},t.prototype._stopAnimation=function(){},t}()},282:function(t,e,n){"use strict";var i=n(23),o=n(30),r=function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function a(t){try{p(i.next(t))}catch(t){r(t)}}function s(t){try{p(i.throw(t))}catch(t){r(t)}}function p(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,s)}p((i=i.apply(t,e||[])).next())}))},a=function(t,e){var n,i,o,r,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return a.label++,{value:r[1],done:!1};case 5:a.label++,i=r[1],r=[0];continue;case 7:r=a.ops.pop(),a.trys.pop();continue;default:if(!(o=(o=a.trys).length>0&&o[o.length-1])&&(6===r[0]||2===r[0])){a=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){a.label=r[1];break}if(6===r[0]&&a.label<o[1]){a.label=o[1],o=r;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(r);break}o[2]&&a.ops.pop(),a.trys.pop();continue}r=e.call(t,a)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},s=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),o=0;for(e=0;e<n;e++)for(var r=arguments[e],a=0,s=r.length;a<s;a++,o++)i[o]=r[a];return i},p=function(){function t(t,e){var n,i,o=this;this.webMap=t,this.options=e,this.opacity=.8,this.pointFitMaxZoom=7,this.polygonFitMaxZoom=12,this._visible=!0,this._timeLayers={},this._layersLoaded={},this._onDataLoadEvents=[],this._onLayerClickMem={},this.name=this.options.name,this._visible=null===(n=this.options.visible)||void 0===n||n,e.order=null!==(i=e.order)&&void 0!==i?i:this.webMap.reserveOrder(),this.order=e.order,void 0!==e.opacity&&(this.opacity=e.opacity),this._waitDataLoaded()&&(t.mapAdapter.emitter.on("data-loaded",(function(t){return o._onData(t)})),t.mapAdapter.emitter.on("data-error",(function(t){return o._onData(t)})))}return t.prototype.hide=function(){var t=this;this._visible&&(Object.keys(this._timeLayers).forEach((function(e){return t._hideLayer(e)})),this._visible=!1)},t.prototype.show=function(){this._visible||(this._visible=!0,this._showLayer(this.currentLayerId))},t.prototype.updateLayer=function(t){var e=this.currentLayerId;return this.currentLayerId=t,this.switchLayer(e,t)},t.prototype.updateLayersColor=function(){var t=this.webMap.mapAdapter.map;if(t&&this.options.getFillColor){var e=this.options.getFillColor({darken:.5}),n=this.options.getFillColor();for(var i in this._layersLoaded)-1!==i.indexOf("-bound")?t.setPaintProperty(i,"line-color",e):t.setPaintProperty(i,"fill-color",n)}},t.prototype.pushDataLoadEvent=function(t){this._onDataLoadEvents.push(t)},t.prototype.fitToFilter=function(t,e){var n=this.webMap.mapAdapter.map;if(n&&"string"==typeof e.source){var i=[];if(e.source.startsWith("ngw:")){var o=(s=n.getSource(e.source))._data,r=this.options.filterIdField||"id";i=o.features.filter((function(e){var n=[].concat(t[2]);return e.properties&&-1!==n.indexOf(e.properties[r])}))}else{var a="ngw:"+(e.options.name||e.id),s=e.source;i=n.querySourceFeatures(s,{filter:t,sourceLayer:a})}if(i&&i.length)return this._fitToFeatures(i),i}},t.prototype.showOnlyCurrentLayer=function(){this.makeOpacity(),this.hideNotCurrentLayers()},t.prototype.switchLayer=function(t,e){var n=this;return new Promise((function(i,o){n._removePopup(),n._cleanDataLoadEvents(),e&&t!==e?(n.pushDataLoadEvent(i),n._showLayer(e).then((function(e){e===n.currentLayerId&&(n._addLayerListeners(e),t&&(n._removeLayerListeners(t),n._setLayerOpacity(e,0)),n._waitDataLoaded()||n._onSourceIsLoaded())})).catch((function(t){o(t)}))):i()})).then((function(){return e}))},t.prototype.hideLayer=function(t){this._hideLayer(t)},t.prototype.getTimeLayer=function(t){return t=void 0!==t?t:this.currentLayerId,this._timeLayers[t]},t.prototype.forEachTimeLayer=function(t,e){var n=this._timeLayers[t];n&&n.forEach((function(t){return e(t)}))},t.prototype.selectLayerFeature=function(t,e){var n=t.properties;if(n&&this.options.filterIdField){var i=this.options.filterIdField,o=n[i],r=this._getWebMapLayer(e);r&&r.select&&r.select([[i,"eq",Number(o)]])}},t.prototype.select=function(t,e,n){void 0===n&&(n=!1),e=null!=e?e:this.currentLayerId;var i=t.split(",").map((function(t){return Number(t)})),o=this._timeLayers[e],r=this.options.filterIdField,a=[];if(o.forEach((function(t){var e=t&&t.layer&&t.layer[0];i&&e&&r&&t&&t.select&&(t.select([[r,"in",i]]),a.push(t))})),n)for(var p=0,c=a;p<c.length;p++){var l=c[p],u=this.fitToFilter(s(["in",r],i),l);if(u&&u.length)return u}},t.prototype.setFilter=function(t){t&&t.length?this._filter=t:this._filter=void 0,this.options.setFilter?this.options.setFilter(this._filter||[],this.currentLayerId):this._updateFilter()},t.prototype._cleanDataLoadEvents=function(){this._onDataLoadEvents=[]},t.prototype.makeOpacity=function(){this._setLayerOpacity(this.currentLayerId,this.opacity)},t.prototype.hideNotCurrentLayers=function(){var t=this;Object.keys(this._timeLayers).forEach((function(e){e!==t.currentLayerId&&t._hideLayer(e)}))},t.prototype._getWebMapLayerId=function(t){return String(t)},t.prototype._getWebMapLayer=function(t){return this.webMap.getLayer(this._getWebMapLayerId(t))},t.prototype._waitDataLoaded=function(){return void 0===this.options.dataLoaded||this.options.dataLoaded},t.prototype._setLayerOpacity=function(t,e){var n=this,i=this._waitDataLoaded();this.forEachTimeLayer(t,(function(t){return i?n.webMap.setLayerOpacity(t,e):0===e?n.webMap.hideLayer(t):n.webMap.showLayer(t)}))},t.prototype._removePopup=function(){this._popup&&(this._popup.remove(),this._popup=void 0)},t.prototype._isCurrentDataLayer=function(t){var e=this._timeLayers[this.currentLayerId];return!!e&&e.some((function(e){return e.id===t||e.options.name===t||e.layer&&e.layer.some((function(e){return e===t}))}))},t.prototype._getLayerIdFromSource=function(t){if(this._timeLayers[t])return t;for(var e in this._timeLayers){var n=this._timeLayers[e].find((function(e){return e.source&&e.source===t||e.options&&e.options.url&&e.options.url===t}));if(n)return n.id}},t.prototype._onData=function(t){var e=this._getLayerIdFromSource(t.target);if(e){var n=this._layersLoaded[e],i=this._isCurrentDataLayer(e),o=this._isHistoryLayer(e);!n&&o&&i&&(this._layersLoaded[e]=!0,this._onSourceIsLoaded())}},t.prototype._onLayerClick=function(t,e,n){var i,r=this.webMap.mapAdapter.map,a=t.point;if(r){var s=r.queryRenderedFeatures([[a.x-2.5,a.y-2.5],[a.x+2.5,a.y+2.5]],{layers:[e]})[0],p=s.properties;if(this.options.createPopupContent){var c=this.options.createPopupContent(p);c&&(this._removePopup(),this._popup=(new o.Popup).setLngLat(t.lngLat).setDOMContent(c).addTo(r))}(null===(i=this.options.selectOnLayerClick)||void 0===i||i)&&this.selectLayerFeature(s,n)}},t.prototype._removeLayerListeners=function(t){var e=this.webMap.mapAdapter.map,n=this._onLayerClickMem[t];if(n&&e)for(var i in n){var o=n[i];o&&e.off(i,o)}this._removePopup()},t.prototype._addLayerListeners=function(t){var e=this,n=this.webMap.mapAdapter.map;n&&this._forEachDataLayer(t,(function(i){var o=function(n){return e._onLayerClick(n,i,t)};n.on("click",i,o),n.on("mouseenter",i,(function(){return n.getCanvas().style.cursor="pointer"})),n.on("mouseleave",i,(function(){return n.getCanvas().style.cursor=""})),e._onLayerClickMem[i]=e._onLayerClickMem[i]||{},e._onLayerClickMem[i].click=o,e._onLayerClickMem[i].mouseenter=o,e._onLayerClickMem[i].mouseleave=o}))},t.prototype._isHistoryLayer=function(t){return!this.webMap.isBaseLayer(t)},t.prototype._isAllDataLayerLoaded=function(t){var e=this;if(!this._waitDataLoaded())return!0;var n=this._timeLayers[t];return n?n.every((function(n){return n.id===t||n.options.name===t||n.layer&&n.layer.some((function(t){return e._layersLoaded[t]}))})):void 0},t.prototype._forEachDataLayer=function(t,e){this.forEachTimeLayer(t,(function(t){return t.layer&&t.layer.forEach((function(t){return e(t)}))}))},t.prototype._onSourceIsLoaded=function(){this._isAllDataLayerLoaded(this.currentLayerId)&&(this.options.manualOpacity||this.showOnlyCurrentLayer(),this._executeDataLoadEvents())},t.prototype._executeDataLoadEvents=function(){for(var t=0;t<this._onDataLoadEvents.length;t++){(0,this._onDataLoadEvents[t])()}this._onDataLoadEvents=[]},t.prototype._addLayer=function(t,e){return r(this,void 0,Promise,(function(){var n,i,o,r;return a(this,(function(a){switch(a.label){case 0:return[4,this.options.addLayers(t,e)];case 1:n=a.sent(),this._timeLayers[e]=[],i=0,o=n,a.label=2;case 2:return i<o.length?[4,o[i]]:[3,5];case 3:r=a.sent(),this._timeLayers[e].push(r),a.label=4;case 4:return i++,[3,2];case 5:return[2,this._timeLayers[e]]}}))}))},t.prototype._toggleLayer=function(t,e){var n=this;this._forEachDataLayer(t,(function(t){n._layersLoaded[t]=!1})),this._layersLoaded[t]=!1,e?this._showLayer(t):this.forEachTimeLayer(t,(function(t){n.webMap.removeLayer(t)}))},t.prototype._hideLayer=function(t){this._toggleLayer(t,!1)},t.prototype._showLayer=function(t){var e=this;if(this._visible){var n=function(){return e.forEachTimeLayer(t,(function(t){return e.webMap.toggleLayer(t,!0)})),t};if(this._getWebMapLayer(t))return Promise.resolve(n());var i=this.options.setUrl?this.options.setUrl({baseUrl:this.options.baseUrl,resourceId:t}):this.options.oldNgwMvtApi?this.options.baseUrl+"/api/resource/"+t+"/{z}/{x}/{y}.mvt":this.newNgwMvtUrl({baseUrl:this.options.baseUrl,resourceId:t});return this._addLayer(i,t).then((function(){return n()}))}return new Promise((function(n,i){setTimeout((function(){e._executeDataLoadEvents(),n(t)}),0)}))},t.prototype.newNgwMvtUrl=function(t){return t.baseUrl+"/api/component/feature_layer/mvt?x={x}&y={y}&z={z}&resource="+t.resourceId},t.prototype._fitToFeatures=function(t){var e=new o.LngLatBounds,n=[],i=function(t){if(2===t.length)try{e.extend(t)}catch(t){}else t.forEach((function(t){i(t)}))};if(t.forEach((function(t){var e=t.geometry;i(e.coordinates),n.push(t.geometry.type)})),this.webMap.mapAdapter.map){var r=n.every((function(t){return"Point"===t}));this.webMap.mapAdapter.map.fitBounds(e,{padding:20,maxZoom:r?this.pointFitMaxZoom:this.polygonFitMaxZoom})}},t.prototype._updateFilter=function(){var t=this,e=this._timeLayers[this.currentLayerId],n=this.options.filterIdField;e.forEach((function(e){n&&e&&e.propertiesFilter&&e.propertiesFilter(t._filter||[])}))},t}();n.d(e,"a",(function(){return l}));var c=0,l=function(){function t(t,e){void 0===e&&(e={}),this.webMap=t,this.options=e,this.emitter=new i.EventEmitter,this._minYear=0,this._maxYear=0,this._timeLayersGroups=[],this._onGroupsLoadEvents=[],this._groupsConfig={}}return t.prototype.getTimeGroup=function(t){return void 0===t&&(t=""),this._timeLayersGroups.find((function(e){return e.name===t}))},t.prototype.getTimeGroupByAdapterId=function(t){return this._getTimeGroupBy((function(e){return e.id===t}))},t.prototype.getTimeGroupByLayerId=function(t){return this._getTimeGroupBy((function(e){var n;return!!(null===(n=e.layer)||void 0===n?void 0:n.includes(t))}))},t.prototype.getTimeGroups=function(){return this._timeLayersGroups},t.prototype.addTimeGroup=function(t){var e=new p(this.webMap,t);this._timeLayersGroups.push(e)},t.prototype.updateByYear=function(t,e){var n=this._getLayerIdsByYear(t,e);n&&this.updateLayers(n),this.options.onLayerUpdate&&this.options.onLayerUpdate(t)},t.prototype.updateLayer=function(t,e){void 0===e&&(e="");var n=this.getTimeGroup(e);return n?n.updateLayer(t).then((function(){return n})):Promise.resolve(void 0)},t.prototype.updateLayers=function(t){var e=this,n=[];this.emitter.emit("loading:start",t);var i=Object.keys(t);return i.forEach((function(i){var o=t[i],r=e.updateLayer(o,i).then((function(t){return function(){t&&(t.showOnlyCurrentLayer(),e.emitter.emit("loading-layer:finish",{layerId:o,layer:t}))}}));n.push(r)})),Promise.all(n).then((function(n){e._timeLayersGroups.forEach((function(t){i.includes(t.name)||t.hideLayer(t.currentLayerId)})),n.forEach((function(t){return t()})),e.reOrderGroupsLayers(),e.emitter.emit("loading:finish",t)}))},t.prototype.pushDataLoadEvent=function(t){var e=this,n=c++,i=this._timeLayersGroups.map((function(t){return new Promise((function(e,n){t.pushDataLoadEvent(e)}))}));return this._onGroupsLoadEvents[n]=t,Promise.all(i).then((function(){var t=e._onGroupsLoadEvents[n];t&&t()})),n},t.prototype.reOrderGroupsLayers=function(){this._timeLayersGroups.forEach((function(t){}))},t.prototype.unselect=function(t){void 0===t&&(t={}),this._timeLayersGroups.forEach((function(e){(!t.exclude||-1===t.exclude.indexOf(e.name))&&e.forEachTimeLayer(e.currentLayerId,(function(t){t.unselect&&t.selected&&t.unselect()}))}))},t.prototype.buildTimeMap=function(t){this._groupsConfig=this._processGroupsMeta(t),this._addTimeLayersGroups(t),!this.currentYear&&this._minYear&&(this.currentYear=this._minYear),Object.values(this._groupsConfig).forEach((function(t){t.layersMeta.sort((function(t,e){return t.from<e.from?-1:1}))}))},t.prototype._addTimeLayersGroups=function(t){var e=this;t.forEach((function(t){var n=e.options.getStatusLayer(t);n&&e.addTimeGroup(n)}))},t.prototype._stepReady=function(t,e,n){var i=this,o=this._getLayersByYear(t,n);if(o||(o=this._getNextLayers(t,n)),o){var r=t;this.nextYear=r;var a=function(){i.currentYear=r,i.nextYear=void 0,e(r)};Object.entries(o).every((function(t){var e=t[0],n=t[1],o=i.getTimeGroup(e);if(o){var r=n&&n.id;return o.currentLayerId===String(r)}return!0}))?a():this.updateLayers(this._layerMetaToIdRecord(o)).then((function(){a()})),this.options.onStepReady&&this.options.onStepReady(r)}else this._minYear&&this._maxYear&&e(n?this._minYear:this._maxYear)},t.prototype._getTimeGroupBy=function(t){for(var e=0;e<this._timeLayersGroups.length;e++){var n=this._timeLayersGroups[e],i=n.getTimeLayer();if(i)for(var o=0;o<i.length;o++){var r=i[o];if(r&&t(r))return{timeGroup:n,timeLayer:r}}}},t.prototype._getLayersByYear=function(t,e){var n=this,i={};return this.getTimeGroups().forEach((function(e){var o=n._groupsConfig[e.name].layersMeta.filter((function(e){return t>=e.from&&t<e.to}));i[e.name]=!!o.length&&o[o.length-1]})),i},t.prototype._getLayerIdsByYear=function(t,e){var n=this._getLayersByYear(t,e);return this._layerMetaToIdRecord(n)},t.prototype._layerMetaToIdRecord=function(t){var e={};return Object.entries(t).forEach((function(t){var n=t[0],i=t[1];i&&(e[n]=String(i.id))})),e},t.prototype._getNextLayers=function(t,e){var n=this._getLayersByYear(t),i={};for(var o in n){var r=n[o],a=void 0,s=this._groupsConfig[o];if(r){if(String(r.id)===this.getTimeGroup(s.name).currentLayerId){var p=s.layersMeta.indexOf(r);-1!==p&&(a=s.layersMeta[e?p-1:p+1])}}else a=e?s.layersMeta.slice().reverse().find((function(e){return e.to<=t})):s.layersMeta.find((function(e){return e.from>=t}));a&&(i[o]=a)}return i},t.prototype._processGroupsMeta=function(t){var e=this,n={};return t.forEach((function(t){var i=[];t.items.forEach((function(t){var n=t.resource,o=n.display_name,r=o.match("(\\d{3,4})_(to_)?(\\d{3,4}).*$");if(r){var a=[r[1],r[3]].map((function(t){return Number(t)})),s=a[0],p=a[1];!(e.options.fromYear&&s<e.options.fromYear||e.options.toYear&&p>e.options.toYear)&&(e._minYear=(e._minYear>s?s:e._minYear)||s,e._maxYear=(e._maxYear<p?p:e._maxYear)||p,i.push({name:o,from:s,to:p,id:n.id}))}})),n[t.name]={layersMeta:i,name:t.name}})),n},t}()},41:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));n(483);var i=n(86),o=n(23),r=function(){function t(t){void 0===t&&(t={}),this.options=t,this.emitter=new o.EventEmitter,this.isHide=!1,this._blocked=!1,this.webMap=this.options.webMap,this._container=this._createContainer()}return t.prototype.getContainer=function(){return this._container},t.prototype.onAdd=function(t){return this.webMap=t,this._container},t.prototype.onRemove=function(){if(this._container){var t=this._container.parentNode;t&&t.removeChild(this._container)}},t.prototype.updateBody=function(t){this._cleanBody(),this._body&&("string"==typeof t?this._body.innerHTML=t:t instanceof HTMLElement&&this._body.appendChild(t))},t.prototype.hide=function(){this.isHide=!0,this._container&&this._container.classList.add("panel-hide"),this.emitter.emit("toggle",!1)},t.prototype.show=function(){this._blocked||(this.isHide=!1,this._container&&this._container.classList.remove("panel-hide"),this.emitter.emit("toggle",!0))},t.prototype.block=function(){this._blocked=!0},t.prototype.unBlock=function(){this._blocked=!1},t.prototype.createControlButton=function(t,e){void 0===e&&(e="Подробнее");var n=document.createElement("button");return n.className="btn panel-button",n.innerHTML=e,n.onclick=t,n},t.prototype.createRefButton=function(t,e){return this.createControlButton((function(){return window.open(t,"_blank")}),e)},t.prototype.openDialog=function(t){this._dialog||(this._dialog=new i.a(t));var e=t&&t.template;e&&(this._dialog.options.template===e||this._dialog.updateContent(e));this._dialog.show()},t.prototype.closeDialog=function(){this._dialog&&this._dialog.close()},t.prototype._cleanBody=function(){this._body&&(this._body.innerHTML="")},t.prototype._createContainer=function(){var t=document.createElement("div");return t.className="mapboxgl-ctrl panel",this.options.addClass&&this.options.addClass.split(" ").forEach((function(e){return t.classList.add(e)})),this.options.headerText,t.appendChild(this._createBody()),t},t.prototype._createHeader=function(){var t=document.createElement("div");return t.className="panel-header",this.options.headerText&&(t.innerHTML=this.options.headerText),this._header=t,t},t.prototype._createBody=function(){var t=document.createElement("div");return t.className="panel-body",this._body=t,t},t}()},478:function(t,e,n){},482:function(t,e,n){},483:function(t,e,n){},486:function(t,e,n){},492:function(t,e,n){},493:function(t,e,n){},61:function(t,e,n){"use strict";n(482);var i=n(41),o=function(){function t(t){this.options=t,this._status=!0,this._status=void 0!==this.options.status?this.options.status:this._status,this._container=this._createContainer(),this._updateContainer()}return t.prototype.getContainer=function(){return this._container},t.prototype.toggle=function(t){void 0===t&&(t=!this._status),this._status=t,this._updateContainer()},t.prototype._createContainer=function(){var t=this,e=document.createElement("div");e.className="panel__toggler",this.options.className&&this.options.className.split(" ").forEach((function(t){return e.classList.add(t)}));var n=this.options.toggleAction;return n&&e.addEventListener("click",(function(){t.toggle(),n(t._status)})),e},t.prototype._updateContainer=function(){var t=this._status?this.options.title:this.options.titleOff;t&&(this._container.title=t,this._status?this._container.classList.add("active"):this._container.classList.remove("active"))},t}(),r=n(86),a=n(84);n.p;function s(t){return new o({className:"baselayer__toggler",title:"Скрыть подложку",titleOff:"Показать подложку",toggleAction:function(e){e?t.app.webMap.showLayer("baselayer"):t.app.webMap.hideLayer("baselayer")}})}function p(t){var e=new r.a(t);return t&&t.template&&e.options.template===t.template||e.updateContent(t.template),e.show(),e}function c(t){var e=t.yearsStatPanelControl;if(e){var n=new o({className:"years__toggler",title:"Скрыть панель изменения в территориальном составе",titleOff:"Показать панель изменения в территориальном составе",toggleAction:function(t){t?(e._blocked=!1,e.show()):(e.hide(),e._blocked=!0)}});return e.emitter.on("toggle",(function(t){n.toggle(t)})),n}}function l(t){var e=t.periodsPanelControl;if(e){var n=new o({className:"period__toggler",title:"Скрыть панель правителей",titleOff:"Показать панель правителей",toggleAction:function(t){t?e.show():e.hide()}});return e.emitter.on("toggle",(function(t){n.toggle(t)})),n}}function u(t){var e=t.legendPanel;if(e){var n=new o({className:"legend__toggler",title:"Скрыть легенду",titleOff:"Показать легенду",toggleAction:function(t){t?e.show():e.hide()}});return e.emitter.on("toggle",(function(t){n.toggle(t)})),n}}function h(t){var e=document.createElement("div");e.className="switcher-panel-control",[u(t),l(t),c(t),s(t)].forEach((function(t){return t&&e.appendChild(t.getContainer())}));var n=new i.a({addClass:"panel-links"});return n.updateBody(e),n}function d(){var t=document.createElement("div");t.innerHTML='\n    <div class="social-links">\n      <a href="http://twitter.com/runivers" class="social__logo twitter"></a>\n      <a href="http://www.facebook.com/Runiverse.ru" class="social__logo facebook"></a>\n      <a href="http://vk.com/public35690973" class="social__logo vkontakte"></a>\n    </div>\n  ';var e=new i.a({addClass:"panel-links"});return e.updateBody(t),e}function f(t){var e=document.createElement("a");return e.className="about_icon",e.setAttribute("href","#"),e.innerHTML="i",e.onclick=function(){!function t(e,n){void 0===n&&(n="ru");var i=e.webMap.getAttributions({onlyVisible:!1,onlyBasemap:!0}),o={ru:'\n<div style="margin-top: 40px;"></div>\n<div class="partner_logos">\n<a href="https://www.runivers.ru" target="_blank"><img src="images/Runivers-Logo-color.svg" /></a>\n<a href="https://www.transneft.ru" target="_blank"><img src="images/Transneft_logo1.png" /></a>\n<a href="https://histgeo.ru/laboratory.html" target="_blank"><img src="images/geolab.png" /></a>\n<a href="https://nextgis.ru" target="_blank"><img src="images/nextgis.png" /></a>\n</div>\n\n<div style="margin-top: 20px;"></div>\n\n<div class="switch-about-language">\n<a class="switch-about-language-btn" name="en" href="#" style="font-size: 1.2rem; font-weight: bold;">\nEnglish version\n</a>\n</div>\n\n<div style="margin-top: 20px;"></div>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<h2>О проекте Границы России 1462-2018 гг.</h2></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="ru-RU"><a href="https://www.runivers.ru" target="_blank">«Руниверс»</a>\nсовместно с <a href="https://histgeo.ru/laboratory.html" target="_blank">Лабораторией исторической\nгеоинформатики</a> Института всеобщей\nистории РАН и компанией <a href="http://nextgis.ru/" target="_blank">NextGIS</a>\nпредставляет проект «Границы России\n1462–2018 гг.».</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="ru-RU">Этот\nкартографический проект содержит\nгеоданные о политических границах\nсовременной России и ее предшественников.\nВажнейшей возможностью, которую\nпредоставляет данная карта, является\nвыбор любого года в интервале карты.\nГод можно выбрать, кликнув мышкой в\nнужном месте ленты времени (в нижней\nчасти карты), либо запустив автоматическую\nпрокрутку ленты времени с шагом в один\nгод, либо, используя иконки + и – справа\nот ленты времени, сдвигаться на один\nгод влево или вправо.</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<A NAME="OLE_LINK210"></A><A NAME="OLE_LINK209"></A>\n<SPAN LANG="ru-RU">Понимая,\nс одной стороны, что формы политического\nстатуса территорий многообразны и, с\nдругой стороны, что это многообразие\nнеобходимо свести к ограниченному числу\nвариантов при отображении на карте, мы\nвыделили всего семь различных статусов\nтерритории России или ее предшественников:</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in">\n<SPAN LANG="ru-RU">1) Основная\nтерритория государства.</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in">\n<SPAN LANG="ru-RU">2) Территория\nпод протекторатом, в вассальной\nзависимости или в сфере влияния.</SPAN></P>\n<P LANG="ru-RU" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in">\n3) Арендованная\nтерритория.</P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in">\n<SPAN LANG="ru-RU">4) Территория\nв совместном владении.</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in">\n<SPAN LANG="ru-RU">5) Спорная\nтерритория.</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="ru-RU">Кроме\nтого, в год изменения конфигурации\nграницы соответствующий участок показан\nотдельным полигоном: как 6) Новая\nтерритория или, напротив, как 7) Утраченная\nтерритория. Эти полигоны также снабжены\nмаркерами, цифра на которых обозначает\nсоответствующую позицию в списке\nтерриториальных изменений информационной\nпанели. В связи с тем, что некоторые\nизменения территории имели место в\nразные месяцы года, иногда полигоны со\nстатусами 6 и 7 задерживаются на карте\nи в следующем после события году.</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<A NAME="OLE_LINK222"></A><A NAME="OLE_LINK221"></A>\n<SPAN LANG="ru-RU">Эта\nдифференциация отражена во всплывающем\nокне, вызываемом по клику мыши на любом\nобъекте внутри политических границ.\nЗаливка соответствующих полигонов\nпередана четырьмя цветами: одним цветом\nпоказана основная территория государства\nи вновь присоединенные земли (статусы\n1 и 6), другим цветом – земли, находящиеся\nв некоторой зависимости от него (статус\n2), третьим – земли арендованные, спорные\nи находящиеся под совместным управлением\nс другими государствами (статусы 3–5).\nУтраченные территории обозначены\nчетвертым цветом (статус 7), однако в\nсилу ряда технических особенностей\nтекущего алгоритма построения геометрий\nне все утраченные территории показаны\nна карте отдельным полигоном. По клику\nна любой полигон можно получить данные\nо хронологическом диапазоне, в котором\nсуществовало данное территориальное\nобразование, и его площади (в квадратных\nкилометрах).</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="ru-RU">В центре\nкаждого такого полигона помещен маркер,\nпомогающий пользователю быстро найти\nсоответствующее место на мелкомасштабной\nкарте. По клику на маркер выдается\nинформация о событии, приведшем к\nпоявлению данного территориального\nобразования.</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="ru-RU">В правом\nверхнем углу карты доступны три\nиконки-кнопки. Первая позволяет отключить\nсовременную картографическую подложку,\nдве другие позволяют управлять\nотображением двух информационных блоков\nкарты. В первом из них отображается имя\nправителя на избранный пользователем\nгод, его титул или должность, годы\nнахождения у власти с отсылкой на\nотдельную страницу сайта с более\nподробными сведениями. В нижнем блоке\nуказаны имевшие место в данном году\nтерриториальные изменения и приведена\nприблизительная площадь участков,\nкоторые добавились к территории\nгосударства и, наоборот, оказались\nутрачены.</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="ru-RU">При\nсоздании веб-ГИС «Границы Московского\nкняжества/Русского царства/Российской\nимперии/СССР/Российской федерации\n(1462–2018 гг.)» реализована концепция\nдинамической карты. С точки зрения\nтехнической реализации проекта эта\nконцепция является оригинальным\nрешением, разработанным в <a href="https://histgeo.ru/laboratory.html" target="_blank">Лабораторией исторической\nгеоинформатики</a> Института\nвсеобщей истории РАН совместно с\n<a href="http://nextgis.ru/" target="_blank">NextGIS</a>.\nОписание <a href="http://nextgis.ru/blog/runivers/" target="_blank">технической реализации</a> проекта.\n</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="ru-RU">Прикладное\nзначение данного проекта для использования\nв научных целях является отличительной\nего чертой. Подобные динамические карты,\nдемонстрирующие изменения границ в\nпрошлом, имеют в основном «образовательный»\nуклон и не могут быть скорректированы\nв результате обсуждения кругом\nспециалистов-историков. Публикуемая\nдинамическая карта, открытая для\nпостоянной корректировки, призвана в\nдальнейшем стать некой картографической\nподосновой для историка, применяющего\nГИС-технологии для решения конкретных\nисследовательских задач.</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="ru-RU">О допущениях,\nособенностях методики и ограничениях\nприменявшейся методики, технических\nособенностях проекта и перспективах\nего развития см. <a\n  href="https://www.runivers.ru/granitsy-rossii/about/about_detailed/index.php"\n  target="_blank"\n>\n  ПОДРОБНЕЕ\n</a>.</SPAN></P>\n',en:'\n<div style="margin-top: 40px;"></div>\n<div class="partner_logos">\n<a href="https://www.runivers.ru" target="_blank"><img src="images/Runivers-Logo-color.svg" /></a>\n<a href="https://www.transneft.ru" target="_blank"><img src="images/Transneft_logo1.png" /></a>\n<a href="https://histgeo.ru/laboratory.html" target="_blank"><img src="images/geolab.png" /></a>\n<a href="https://nextgis.com" target="_blank"><img src="images/nextgis.png" /></a>\n</div>\n<div style="margin-top: 40px;"></div>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<h2>Russia’s Borders from 1462 through 2018’ Project</h2></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n\n<SPAN LANG="en-EN"><a href="https://www.runivers.ru" target="_blank">Runivers</a>\n\npresents ‘Russia’s Borders from 1462 through 2018’ –\na project designed in collaboration with the\n<a href="https://histgeo.ru/laboratory.html" target="_blank">\nLaboratory of Historical Geomatics</a> at the Institute of World History\nof the Russian Academy of Sciences (RAS) and\n<a href="http://nextgis.com" target="_blank">NextGIS Ltd.</a>\n</SPAN></P>\n\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="en-EN">\nThis cartographic project contains geographical information on the political borders\nof the contemporary Russian Federation and its predecessor states.\nAn opportunity to select any year in the 1462 to 2018 time bracket is a crucial option of this map.\nTo choose the needed year, the users either click at the needed point on the timeline (at the bottom of the map)\nor launch its step-by-step automatic rewinding or else use the + or –\nicons to the right of the timeline, thus moving one year backwards or forwards.\n</SPAN></P>\n\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<A NAME="OLE_LINK210"></A><A NAME="OLE_LINK209"></A>\n<SPAN LANG="en-EN">\nThe realization that the forms of a political status of lands are multiple and that,\non the other hand, this diversity should be reduced to a limited number of versions for\ndepiction on the map has prompted us to single out seven different statuses of the territory\nof today’s Russia and its predecessors.\n</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in">\n<SPAN LANG="en-EN">\n1) The mainland of the state.\n</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in">\n<SPAN LANG="en-EN">\n2) A territory under protectorate, vassal allegiance or in the sphere of influence.\n</SPAN></P>\n<P LANG="en-EN" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in">\n3) A leased territory.\n</P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in">\n<SPAN LANG="en-EN">\n4) A territory in joint possession.\n</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0in">\n<SPAN LANG="en-EN">\n5) A litigious territory.\n</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<A NAME="OLE_LINK222"></A><A NAME="OLE_LINK221"></A>\n<SPAN LANG="en-EN">\nChanges in the configuration of the border in relevant years are shown in separate polygons as: 6.\nthe newly acquired territories or, 7. lost territories.\nThese polygons have the tokens, the numbers on which correspond to positions in the list of\nterritorial changes found in the info bar.\nTerritorial changes occurred in different months of the year – sometimes in the first half of the year,\nand sometime in the second half, and that is why the polygons with statuses 6 and 7 sometimes stay on\nand get over to the year that followed a specified event.\n</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="en-EN">\nThe differentiation is reflected in popup windows,\nwhich the users can bring up by clicking at any object inside the political borders.\nThe polygons are filled with four colors. One color shows the mainland of the state and the newly\nincorporated lands (statuses 1 and 6); the second color marks the lands that have a certain degree\nof dependence on the state (status 2); the third color brings out the leased and litigious areas or\nthe lands governed jointly with other countries (statuses 3 and 5).\nThe lost territories (status 7) are marked with the fourth color but owing to certain technology\npeculiarities of the current algorithm of geometrical arrangements formation some of the lost territories\nare not displayed on the map with the aid of separate polygons. A click at any polygon will call up\nthe information on the chronological range, in which a territorial entity existed, and on its size (in sq. km).\n</SPAN></P>\n\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="en-EN">\nPlaced in the center of each polygon is a token that helps the users find an appropriate\nlocation on a small-scale map. A click at the token will retrieve the data on the event\nthat resulted in the formation of the specific territorial entity.\n</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="en-EN">\nThree button icons are available in the upper right-hand corner of the map.\nThe first one switches the contemporary basemap off, while two others make it\npossible to handle the presentation of two data units of the map.\nThe first unit shows the name, title/ official position and the years in office of the person\nwho ruled the territory in the year chosen by the user. It also contains a reference to a special page\nat the website that offers detailed information. The lower data unit provides information\non the territorial changes in the selected year, as well as on an approximate size of the lands\nthat were incorporated into the nation or, vice versa, were lost.\n</SPAN></P>\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="en-EN">\n‘The Borders of the Duchy of Muscovy/ Czardom of Russia/ Russian Empire/ USSR/\nRussian Federation from 1462 through 2018’ web GIS rests on the concept of a dynamic map.\nAs regards the technical implementation, this concept embodies an original solution developed at the\n<a href="https://histgeo.ru/laboratory.html" target="_blank">Laboratory of Historical Geomatics</a>\nof the RAS Institute of World History in cooperation with\n<a href="http://nextgis.com" target="_blank">NextGIS Ltd.</a>\n</SPAN></P>\n\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="en-EN">\nPractical applicability of this project for research purposes makes it stand out among other projects of this kind.\nThe dynamic maps displaying the past changes of state borders most typically have an educational\nfocus and historians do not have a chance to amend them after expert debates.\nConversely, the dynamic map released now is open for future amendments and is called upon\nto serve as an instrumental cartographic aid for the scholars of history who use GIS technologies\nto attain specified research objectives.\n\n\n<P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n<SPAN LANG="en-EN">\nTechnical implementation  <a href="http://nextgis.com/blog/runivers/" target="_blank">description</a>.\n</SPAN></P>\n'}[n];if(i.length){var a="ru"===n?"Использована картографическая подложка: ":"The basemap used: ";i.forEach((function(t){a+=t})),o+='\n    <P LANG="en-GB" CLASS="western" ALIGN=JUSTIFY STYLE="margin-bottom: 0.17in">\n      <SPAN LANG="ru-RU">'+a+"</SPAN>\n    </P>"}var s=document.createElement("div");s.innerHTML=o;var c=s.getElementsByClassName("switch-about-language-btn")[0];c&&(c.onclick=function(){r.a.clean(),t(e,c.name)}),p({template:s})}(t,"ru")},e}function m(t){var e=document.createElement("div");e.innerHTML='\n  <a href="https://www.runivers.ru"\n    title="Электронная  энциклопедия и библиотека Руниверс"\n    class="affiliated-logo runiver__logo__min" target="_blank"\n  ></a>\n  <a href="https://histgeo.ru/laboratory.html"\n    class="affiliated-logo laboratory__logo__min" target="_blank"\n    title="Лаборатория исторической геоинформатики"\n  ></a>\n  <a href="https://www.transneft.ru"\n    class="affiliated-logo transneft__logo__min" target="_blank"\n    title="ПАО «Транснефть»"\n  ></a>\n  <a href="https://nextgis.ru"\n    class="affiliated-logo nextgis__logo__min" target="_blank"\n    title="Разработка ГИС и проекты"\n  ></a>\n  <a href="#" class="affiliated-logo settings__logo__min" target="_blank" title="Настройки"></a>\n  ';var n=e.getElementsByClassName("settings__logo__min")[0];return n&&(n.onclick=function(e){e.preventDefault(),function(t){var e=document.createElement("div"),n=document.createElement("div");n.className="settings-dialog__header",n.innerHTML="\n    <h2>Настройки</h2>\n  ",e.appendChild(n);var i=t.slider;[{name:"animationDelay",label:"Задержка анимации, мс",type:"number"},{name:"step",label:"Шаг изменения года",type:"number"},{name:"animationStep",label:"Шаг изменения года (анимация)",type:"number"}].forEach((function(t){var n=t.name+"-"+Math.round(1e4*Math.random()),o=document.createElement("label");o.className="settings-dialog__input-block",o.innerHTML='<div class="settings-dialog__input-block--label">'+t.label+': </div>\n      <input class="'+n+'" class=type='+t.type+" value="+i.options[t.name]+">\n      </input>\n    ";var r=o.getElementsByClassName(n)[0];r.addEventListener("input",(function(){var e="number"===t.type?parseInt(r.value,10):r.value;Object.defineProperty(i.options,t.name,{value:e,enumerable:!0})})),e.appendChild(o)}));var o=t.controls.legendPanel&&t.controls.legendPanel.createLegendBlock(!0);o&&e.appendChild(o);var r=document.createElement("div");r.className="settings-dialog__read-more",r.innerHTML='\n    Описание технической реализации проекта доступно по\n    <a href="http://nextgis.ru/blog/runivers/" target="_blank">ссылке</a>.\n    <div>v.'+a.version+"</div>\n  ",e.appendChild(r),p({template:e})}(t)}),e}function y(t){return t.app.webMap.createButtonControl({addClass:"mapboxgl-ctrl-icon mapboxgl-ctrl-home",onClick:function(){return t.app.options.bounds&&t.app.webMap.fitBounds(t.app.options.bounds)}})}n.d(e,"e",(function(){return h})),n.d(e,"d",(function(){return d})),n.d(e,"a",(function(){return f})),n.d(e,"b",(function(){return m})),n.d(e,"c",(function(){return y}))}}]);